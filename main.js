/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __esm = (fn, res) => function __init() {
  return fn && (res = (0, fn[__getOwnPropNames(fn)[0]])(fn = 0)), res;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/scanner.ts
async function scanVault(plugin) {
  const vault = plugin.app.vault;
  const patterns = plugin.settings.patterns.map((p) => new RegExp(p, "g"));
  const results = [];
  for (const file of vault.getMarkdownFiles()) {
    const content = await vault.cachedRead(file);
    const lines = content.split("\n");
    lines.forEach((lineText, lineNum) => {
      patterns.forEach((re) => {
        var _a;
        for (const m of lineText.matchAll(re)) {
          results.push({
            file,
            line: lineNum,
            col: (_a = m.index) != null ? _a : 0,
            text: m[0]
          });
        }
      });
    });
  }
  return results;
}
var init_scanner = __esm({
  "src/scanner.ts"() {
  }
});

// src/crypto.ts
async function deriveKey(pwd) {
  const enc = new TextEncoder();
  const keyMaterial = await crypto.subtle.importKey(
    "raw",
    enc.encode(pwd),
    { name: "PBKDF2" },
    false,
    ["deriveKey"]
  );
  return crypto.subtle.deriveKey(
    {
      name: "PBKDF2",
      salt: enc.encode("pii-salt"),
      iterations: 5e4,
      hash: "SHA-256"
    },
    keyMaterial,
    { name: "AES-GCM", length: 256 },
    false,
    ["encrypt", "decrypt"]
  );
}
async function encrypt(text, pwd) {
  const iv = crypto.getRandomValues(new Uint8Array(12));
  const key = await deriveKey(pwd);
  const enc = new TextEncoder().encode(text);
  const buf = await crypto.subtle.encrypt({ name: "AES-GCM", iv }, key, enc);
  return `${Buffer.from(iv).toString("base64")}.${Buffer.from(buf).toString("base64")}`;
}
async function decrypt(data, pwd) {
  const [ivB64, bufB64] = data.split(".");
  const iv = Uint8Array.from(Buffer.from(ivB64, "base64"));
  const buf = Buffer.from(bufB64, "base64");
  const key = await deriveKey(pwd);
  const dec = await crypto.subtle.decrypt({ name: "AES-GCM", iv }, key, buf);
  return new TextDecoder().decode(dec);
}
var init_crypto = __esm({
  "src/crypto.ts"() {
  }
});

// ui/PiiSidebarView.ts
var PiiSidebarView_exports = {};
__export(PiiSidebarView_exports, {
  PiiSidebarView: () => PiiSidebarView,
  PwModal: () => PwModal,
  VIEW_TYPE_PII: () => VIEW_TYPE_PII
});
var import_obsidian, VIEW_TYPE_PII, makeUUID, PwModal, PiiSidebarView;
var init_PiiSidebarView = __esm({
  "ui/PiiSidebarView.ts"() {
    import_obsidian = require("obsidian");
    init_scanner();
    init_crypto();
    VIEW_TYPE_PII = "pii-sidebar-view";
    makeUUID = () => {
      var _a, _b;
      return (_b = (_a = crypto.randomUUID) == null ? void 0 : _a.call(crypto)) != null ? _b : Date.now().toString(36) + Math.random().toString(36).slice(2, 10);
    };
    PwModal = class extends import_obsidian.Modal {
      constructor(app, title, isEncrypt = false) {
        super(app);
        this.title = title;
        this.isEncrypt = isEncrypt;
      }
      onOpen() {
        const { containerEl } = this;
        containerEl.empty();
        containerEl.addClass("pii-modal");
        const contentContainer = containerEl.createDiv({
          cls: "pii-modal-content"
        });
        const titleEl = contentContainer.createEl("h3", {
          cls: "pii-modal-title"
        });
        const icon = this.isEncrypt ? "\u{1F512}" : "\u{1F513}";
        titleEl.innerHTML = `${icon} ${this.title}`;
        const description = this.isEncrypt ? "Enter a password to encrypt your sensitive information. Remember this password as you'll need it to decrypt later." : "Enter your password to decrypt the protected information.";
        contentContainer.createEl("p", {
          text: description,
          cls: "pii-modal-description"
        });
        let pw = "";
        let showPassword = false;
        const formContainer = contentContainer.createDiv({
          cls: "pii-modal-form"
        });
        const pwContainer = formContainer.createDiv({
          cls: "pii-password-container"
        });
        pwContainer.createEl("label", {
          text: "Password",
          cls: "pii-input-label"
        });
        const pwInputWrapper = pwContainer.createDiv({
          cls: "pii-input-wrapper"
        });
        const pwInput = pwInputWrapper.createEl("input", {
          type: "password",
          placeholder: this.isEncrypt ? "Create a strong password" : "Enter your password",
          cls: "pii-password-input"
        });
        pwInput.addEventListener("input", (e) => {
          pw = e.target.value;
        });
        pwInput.focus();
        pwInput.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            if (this.isEncrypt) {
              this.validateAndSubmit(pw, confirmPw);
            } else {
              this.submit(pw);
            }
          }
        });
        const toggleBtn = pwInputWrapper.createEl("button", {
          cls: "pii-password-toggle",
          text: "\u{1F441}\uFE0F"
          // Eye icon
        });
        toggleBtn.addEventListener("click", (e) => {
          e.preventDefault();
          showPassword = !showPassword;
          pwInput.type = showPassword ? "text" : "password";
          toggleBtn.textContent = showPassword ? "\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F" : "\u{1F441}\uFE0F";
        });
        let confirmPw = "";
        let confirmInput = null;
        if (this.isEncrypt) {
          const confirmContainer = formContainer.createDiv({
            cls: "pii-password-container"
          });
          confirmContainer.createEl("label", {
            text: "Confirm Password",
            cls: "pii-input-label"
          });
          const confirmInputWrapper = confirmContainer.createDiv({
            cls: "pii-input-wrapper"
          });
          confirmInput = confirmInputWrapper.createEl("input", {
            type: "password",
            placeholder: "Confirm your password",
            cls: "pii-password-input"
          });
          confirmInput.addEventListener("input", (e) => {
            confirmPw = e.target.value;
          });
          confirmInput.addEventListener("keydown", (e) => {
            if (e.key === "Enter") {
              this.validateAndSubmit(pw, confirmPw);
            }
          });
          const confirmToggleBtn = confirmInputWrapper.createEl("button", {
            cls: "pii-password-toggle",
            text: "\u{1F441}\uFE0F"
            // Eye icon
          });
          confirmToggleBtn.addEventListener("click", (e) => {
            e.preventDefault();
            showPassword = !showPassword;
            if (confirmInput) {
              confirmInput.type = showPassword ? "text" : "password";
            }
            confirmToggleBtn.textContent = showPassword ? "\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F" : "\u{1F441}\uFE0F";
            pwInput.type = showPassword ? "text" : "password";
            toggleBtn.textContent = showPassword ? "\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F" : "\u{1F441}\uFE0F";
          });
        }
        const buttonContainer = contentContainer.createDiv({
          cls: "pii-modal-buttons"
        });
        const cancelBtn = buttonContainer.createEl("button", {
          text: "Cancel",
          cls: "pii-btn-secondary"
        });
        cancelBtn.onclick = () => this.close();
        const actionText = this.isEncrypt ? "Encrypt" : "Decrypt";
        const submitBtn = buttonContainer.createEl("button", {
          text: actionText,
          cls: "pii-btn-primary"
        });
        submitBtn.onclick = () => {
          if (this.isEncrypt) {
            this.validateAndSubmit(pw, confirmPw);
          } else {
            this.submit(pw);
          }
        };
      }
      validateAndSubmit(pw, confirmPw) {
        if (!pw) {
          new import_obsidian.Notice("Please enter a password");
          return;
        }
        if (this.isEncrypt && pw !== confirmPw) {
          new import_obsidian.Notice("Passwords do not match");
          return;
        }
        this.submit(pw);
      }
      submit(pw) {
        this.close();
        this._resolve(pw || null);
      }
      onClose() {
        this.contentEl.empty();
      }
      wait() {
        this.open();
        return new Promise((res) => this._resolve = res);
      }
    };
    PiiSidebarView = class extends import_obsidian.ItemView {
      constructor(leaf, plugin) {
        super(leaf);
        this.plugin = plugin;
        this.matches = [];
        this.searchResults = [];
        this.manualSelections = [];
        this.selected = /* @__PURE__ */ new Set();
        this.cachedPassword = null;
        this.currentMode = "scan";
      }
      getViewType() {
        return VIEW_TYPE_PII;
      }
      getDisplayText() {
        return "Lock and Find";
      }
      getIcon() {
        return "shield";
      }
      async onOpen() {
        const e = this.containerEl;
        e.empty();
        this.setupTextSelectionDragDrop();
        const modeContainer = e.createEl("div", { cls: "pii-mode-toggle" });
        const scanModeBtn = modeContainer.createEl("button", {
          cls: this.currentMode === "scan" ? "pii-btn-primary" : "pii-btn-secondary",
          text: "Scan Mode"
        });
        const searchModeBtn = modeContainer.createEl("button", {
          cls: this.currentMode === "search" ? "pii-btn-primary" : "pii-btn-secondary",
          text: "Search Mode"
        });
        scanModeBtn.onclick = () => {
          this.currentMode = "scan";
          scanModeBtn.className = "pii-btn-primary";
          searchModeBtn.className = "pii-btn-secondary";
          this.render();
        };
        searchModeBtn.onclick = () => {
          this.currentMode = "search";
          scanModeBtn.className = "pii-btn-secondary";
          searchModeBtn.className = "pii-btn-primary";
          this.render();
        };
        const scanControls = e.createEl("div", { cls: "pii-scan-controls" });
        const scan = scanControls.createEl("button", { cls: "pii-btn-primary pii-btn-half" });
        scan.innerHTML = '<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M15.5,12C18,12 20,14 20,16.5C20,17.38 19.75,18.21 19.31,18.9L22.39,22L21,23.39L17.88,20.32C17.19,20.75 16.37,21 15.5,21C13,21 11,19 11,16.5C11,14 13,12 15.5,12M15.5,14A2.5,2.5 0 0,0 13,16.5A2.5,2.5 0 0,0 15.5,19A2.5,2.5 0 0,0 18,16.5A2.5,2.5 0 0,0 15.5,14M5,3H19C20.11,3 21,3.89 21,5V13.03C20.5,12.23 19.81,11.54 19,11V5H5V19H9.5C9.81,19.75 10.26,20.42 10.81,21H5C3.89,21 3,20.11 3,19V5C3,3.89 3.89,3 5,3M7,7H17V9H7V7M7,11H12.03C11.23,11.5 10.54,12.19 10,13H7V11M7,15H9.17C9.06,15.5 9,16 9,16.5V17H7V15Z"></path></svg> Scan Vault';
        const clear = scanControls.createEl("button", { cls: "pii-btn-secondary pii-btn-half" });
        clear.innerHTML = '<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"></path></svg> Clear';
        scan.onclick = async () => {
          scan.disabled = true;
          scan.innerHTML = '<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"><animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 12 12" to="360 12 12" repeatCount="indefinite" /></path></svg> Scanning...';
          this.matches = await scanVault(this.plugin);
          this.selected.clear();
          this.render();
          scan.disabled = false;
          scan.innerHTML = '<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M15.5,12C18,12 20,14 20,16.5C20,17.38 19.75,18.21 19.31,18.9L22.39,22L21,23.39L17.88,20.32C17.19,20.75 16.37,21 15.5,21C13,21 11,19 11,16.5C11,14 13,12 15.5,12M15.5,14A2.5,2.5 0 0,0 13,16.5A2.5,2.5 0 0,0 15.5,19A2.5,2.5 0 0,0 18,16.5A2.5,2.5 0 0,0 15.5,14M5,3H19C20.11,3 21,3.89 21,5V13.03C20.5,12.23 19.81,11.54 19,11V5H5V19H9.5C9.81,19.75 10.26,20.42 10.81,21H5C3.89,21 3,20.11 3,19V5C3,3.89 3.89,3 5,3M7,7H17V9H7V7M7,11H12.03C11.23,11.5 10.54,12.19 10,13H7V11M7,15H9.17C9.06,15.5 9,16 9,16.5V17H7V15Z"></path></svg> Scan Vault';
        };
        clear.onclick = () => {
          this.matches = [];
          this.searchResults = [];
          this.manualSelections = [];
          this.selected.clear();
          this.render();
        };
        const searchContainer = e.createEl("div", { cls: "pii-search-container" });
        const searchInput = searchContainer.createEl("input", {
          type: "text",
          placeholder: "Search for text to encrypt...",
          cls: "pii-search-input"
        });
        const searchBtn = searchContainer.createEl("button", { cls: "pii-btn-primary" });
        searchBtn.innerHTML = '<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M15.5,12C18,12 20,14 20,16.5C20,17.38 19.75,18.21 19.31,18.9L22.39,22L21,23.39L17.88,20.32C17.19,20.75 16.37,21 15.5,21C13,21 11,19 11,16.5C11,14 13,12 15.5,12M15.5,14A2.5,2.5 0 0,0 13,16.5A2.5,2.5 0 0,0 15.5,19A2.5,2.5 0 0,0 18,16.5A2.5,2.5 0 0,0 15.5,14Z"></path></svg> Search';
        searchBtn.onclick = async () => {
          const query = searchInput.value.trim();
          if (!query) {
            new import_obsidian.Notice("Please enter search text");
            return;
          }
          searchBtn.disabled = true;
          searchBtn.innerHTML = '<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"><animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 12 12" to="360 12 12" repeatCount="indefinite" /></path></svg> Searching...';
          this.searchResults = await this.searchVault(query);
          this.selected.clear();
          this.render();
          searchBtn.disabled = false;
          searchBtn.innerHTML = '<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M15.5,12C18,12 20,14 20,16.5C20,17.38 19.75,18.21 19.31,18.9L22.39,22L21,23.39L17.88,20.32C17.19,20.75 16.37,21 15.5,21C13,21 11,19 11,16.5C11,14 13,12 15.5,12M15.5,14A2.5,2.5 0 0,0 13,16.5A2.5,2.5 0 0,0 15.5,19A2.5,2.5 0 0,0 18,16.5A2.5,2.5 0 0,0 15.5,14Z"></path></svg> Search';
        };
        searchInput.addEventListener("keydown", (e2) => {
          if (e2.key === "Enter") {
            searchBtn.click();
          }
        });
        e.createEl("hr");
        const listContainer = e.createEl("div", { cls: "pii-list" });
        const dropArea = e.createEl("div", { cls: "pii-drop" });
        dropArea.createEl("div", { cls: "pii-drop-icon", text: "" });
        dropArea.createEl("div", { text: "Drag items here to encrypt" });
        const bot = e.createEl("div", { cls: "pii-btn-bar-bottom" });
        const lockBtn = bot.createEl("button", { cls: "pii-btn-primary pii-btn-half" });
        lockBtn.innerHTML = '<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"></path></svg> Lock Selected';
        lockBtn.onclick = () => this.lock();
        const unlockBtn = bot.createEl("button", { cls: "pii-btn-secondary pii-btn-half" });
        unlockBtn.innerHTML = '<svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10A2,2 0 0,1 6,8H15V6A3,3 0 0,0 12,3A3,3 0 0,0 9,6H7A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,17A2,2 0 0,0 14,15A2,2 0 0,0 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17Z"></path></svg> Unlock All';
        unlockBtn.onclick = () => this.unlock();
      }
      async onClose() {
        this.containerEl.empty();
        this.cleanupTextSelectionDragDrop();
      }
      /* -------- Text Selection Drag & Drop Setup -------- */
      setupTextSelectionDragDrop() {
        document.addEventListener("mouseup", this.handleTextSelection.bind(this));
        document.addEventListener("dragstart", this.handleDragStart.bind(this));
      }
      cleanupTextSelectionDragDrop() {
        document.removeEventListener("mouseup", this.handleTextSelection.bind(this));
        document.removeEventListener("dragstart", this.handleDragStart.bind(this));
      }
      handleTextSelection(event) {
        const selection = window.getSelection();
        if (!selection || selection.rangeCount === 0)
          return;
        const selectedText = selection.toString().trim();
        if (!selectedText)
          return;
        const target = event.target;
        const editorContainer = target.closest(".markdown-source-view, .cm-editor");
        if (!editorContainer)
          return;
        const range = selection.getRangeAt(0);
        if (range.collapsed)
          return;
        try {
          const span = document.createElement("span");
          span.draggable = true;
          span.style.backgroundColor = "var(--text-selection)";
          span.style.cursor = "grab";
          span.title = "Drag to encrypt this text";
          span.setAttribute("data-selected-text", selectedText);
          range.surroundContents(span);
          setTimeout(() => {
            if (span && span.parentNode) {
              const parent = span.parentNode;
              while (span.firstChild) {
                parent.insertBefore(span.firstChild, span);
              }
              parent.removeChild(span);
            }
          }, 5e3);
        } catch (e) {
          console.log("Could not make selection draggable:", e);
        }
      }
      handleDragStart(event) {
        const target = event.target;
        const selectedText = target.getAttribute("data-selected-text");
        if (selectedText && event.dataTransfer) {
          event.dataTransfer.setData("text/plain", selectedText);
          event.dataTransfer.setData("application/x-selected-text", selectedText);
          event.dataTransfer.effectAllowed = "copy";
        }
      }
      /* -------- Search Vault -------- */
      async searchVault(query) {
        const results = [];
        const files = this.app.vault.getMarkdownFiles();
        for (const file of files) {
          const content = await this.app.vault.cachedRead(file);
          const lines = content.split("\n");
          for (let i = 0; i < lines.length; i++) {
            const line = lines[i];
            let index = 0;
            while ((index = line.toLowerCase().indexOf(query.toLowerCase(), index)) !== -1) {
              const match = {
                text: line.substring(index, index + query.length),
                file,
                line: i,
                col: index
              };
              results.push(match);
              index += query.length;
            }
          }
        }
        return results;
      }
      /* -------- Render UI -------- */
      render() {
        const list = this.containerEl.querySelector(".pii-list");
        const drop = this.containerEl.querySelector(".pii-drop");
        const searchContainer = this.containerEl.querySelector(".pii-search-container");
        const scanControls = this.containerEl.querySelector(".pii-scan-controls");
        const modeContainer = this.containerEl.querySelector(".pii-mode-toggle");
        if (searchContainer) {
          searchContainer.style.display = this.currentMode === "search" ? "flex" : "none";
        }
        if (scanControls) {
          scanControls.style.display = this.currentMode === "scan" ? "flex" : "none";
        }
        list.empty();
        drop.empty();
        drop.createEl("div", { cls: "pii-drop-icon", text: "\u{1F512}" });
        drop.createEl("div", { text: "Drag items here to encrypt" });
        const currentResults = this.currentMode === "scan" ? this.matches : this.searchResults;
        const emptyMessage = this.currentMode === "scan" ? "No sensitive information found" : "No search results found";
        if (!currentResults.length) {
          list.createEl("div", { cls: "pii-empty" });
          list.createEl("div", { cls: "pii-empty" }).innerHTML = '<svg viewBox="0 0 24 24" width="32" height="32" style="opacity: 0.5"><path fill="currentColor" d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,10.5A1.5,1.5 0 0,0 10.5,12A1.5,1.5 0 0,0 12,13.5A1.5,1.5 0 0,0 13.5,12A1.5,1.5 0 0,0 12,10.5M7.5,10.5A1.5,1.5 0 0,0 6,12A1.5,1.5 0 0,0 7.5,13.5A1.5,1.5 0 0,0 9,12A1.5,1.5 0 0,0 7.5,10.5M16.5,10.5A1.5,1.5 0 0,0 15,12A1.5,1.5 0 0,0 16.5,13.5A1.5,1.5 0 0,0 18,12A1.5,1.5 0 0,0 16.5,10.5Z"></path></svg>';
          list.createEl("p", { text: emptyMessage });
          return;
        }
        currentResults.forEach((m, i) => {
          const row = list.createEl("div", { cls: "pii-row" });
          const textEl = row.createEl("div", { cls: "pii-row-text", text: m.text });
          row.createEl("div", { cls: "pii-row-location", text: `${m.file.basename}:${m.line + 1}` });
          row.setAttr("draggable", "true");
          row.ondragstart = (e) => {
            var _a;
            return (_a = e.dataTransfer) == null ? void 0 : _a.setData("text/plain", String(i));
          };
          row.onclick = async () => {
            var _a;
            const leaf = this.app.workspace.getLeaf(false);
            await leaf.openFile(m.file);
            (_a = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView)) == null ? void 0 : _a.editor.setCursor({ line: m.line, ch: m.col });
          };
        });
        drop.ondragover = (e) => {
          e.preventDefault();
          drop.addClass("hover");
        };
        drop.ondragleave = () => drop.removeClass("hover");
        drop.ondrop = (e) => {
          var _a, _b;
          e.preventDefault();
          drop.removeClass("hover");
          const selectedText = (_a = e.dataTransfer) == null ? void 0 : _a.getData("application/x-selected-text");
          if (selectedText) {
            this.addManualSelection(selectedText, drop);
            return;
          }
          const i = parseInt(((_b = e.dataTransfer) == null ? void 0 : _b.getData("text/plain")) || "-1");
          if (i >= 0 && !this.selected.has(i)) {
            this.selected.add(i);
            const tag = drop.createEl("div", { cls: "pii-tag" });
            tag.textContent = currentResults[i].text;
            const removeBtn = tag.createEl("span", { cls: "pii-tag-remove", text: "\xD7" });
            removeBtn.style.marginLeft = "4px";
            removeBtn.style.cursor = "pointer";
            removeBtn.style.fontWeight = "bold";
            removeBtn.onclick = (evt) => {
              evt.stopPropagation();
              this.selected.delete(i);
              tag.remove();
            };
          }
        };
      }
      /* -------- Add Manual Selection -------- */
      addManualSelection(text, dropArea) {
        const id = makeUUID();
        this.manualSelections.push({ text, id });
        const tag = dropArea.createEl("div", { cls: "pii-tag pii-tag-manual" });
        tag.textContent = text;
        tag.setAttribute("data-manual-id", id);
        const removeBtn = tag.createEl("span", { cls: "pii-tag-remove", text: "\xD7" });
        removeBtn.style.marginLeft = "4px";
        removeBtn.style.cursor = "pointer";
        removeBtn.style.fontWeight = "bold";
        removeBtn.onclick = (evt) => {
          evt.stopPropagation();
          this.manualSelections = this.manualSelections.filter((s) => s.id !== id);
          tag.remove();
        };
        new import_obsidian.Notice(`Added "${text.substring(0, 30)}${text.length > 30 ? "..." : ""}" for encryption`);
      }
      /* -------- Encrypt Manual Selection -------- */
      async encryptManualSelection(text, password) {
        const activeFile = this.app.workspace.getActiveFile();
        if (!activeFile) {
          throw new Error("No active file to encrypt text in");
        }
        let fileContent = await this.app.vault.cachedRead(activeFile);
        const index = fileContent.indexOf(text);
        if (index === -1) {
          console.warn(`Text not found in active file: ${text.substring(0, 50)}`);
          return;
        }
        const cipher = await encrypt(text, password);
        const wrapped = `<details>
 <summary>Lock</summary>
 \xA7ENC_${makeUUID().slice(0, 6)}_${cipher}\xA7
</details>`;
        fileContent = fileContent.substring(0, index) + wrapped + fileContent.substring(index + text.length);
        await this.app.vault.modify(activeFile, fileContent);
      }
      /* -------- Get Password (with caching) -------- */
      async getPassword(isEncrypt = false) {
        if (this.cachedPassword) {
          return this.cachedPassword;
        }
        if (!isEncrypt && this.plugin.settings.storedPassword) {
          const pwd2 = await new PwModal(this.app, "Enter Your Password", false).wait();
          if (pwd2) {
            const encoder = new TextEncoder();
            const data = encoder.encode(pwd2);
            const hashBuffer = await crypto.subtle.digest("SHA-256", data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map((b) => b.toString(16).padStart(2, "0")).join("");
            if (hashHex === this.plugin.settings.storedPassword) {
              this.cachedPassword = pwd2;
              return pwd2;
            } else {
              new import_obsidian.Notice("Incorrect password");
              return null;
            }
          }
          return null;
        }
        const title = isEncrypt ? "Encrypt Sensitive Information" : "Decrypt Protected Information";
        const pwd = await new PwModal(this.app, title, isEncrypt).wait();
        if (pwd) {
          this.cachedPassword = pwd;
          if (isEncrypt && !this.plugin.settings.storedPassword) {
            const encoder = new TextEncoder();
            const data = encoder.encode(pwd);
            const hashBuffer = await crypto.subtle.digest("SHA-256", data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map((b) => b.toString(16).padStart(2, "0")).join("");
            this.plugin.settings.storedPassword = hashHex;
            await this.plugin.saveSettings();
            new import_obsidian.Notice("Password saved for future use");
          }
        }
        return pwd;
      }
      /* -------- Clear cached password -------- */
      clearCachedPassword() {
        this.cachedPassword = null;
      }
      /* -------- Encrypt (Lock) -------- */
      async lock() {
        const currentResults = this.currentMode === "scan" ? this.matches : this.searchResults;
        if (!this.selected.size) {
          currentResults.forEach((_, i) => this.selected.add(i));
        }
        if (!this.selected.size && !this.manualSelections.length) {
          new import_obsidian.Notice("No items selected for encryption");
          return;
        }
        const pwd = await this.getPassword(true);
        if (!pwd)
          return;
        const totalItems = this.selected.size + this.manualSelections.length;
        const statusBar = this.containerEl.createEl("div", {
          cls: "pii-status",
          text: `Encrypting ${totalItems} item(s)...`
        });
        try {
          let processedCount = 0;
          for (const i of this.selected) {
            const m = currentResults[i];
            const file = m.file;
            let text = await this.app.vault.cachedRead(file);
            const cipher = await encrypt(m.text, pwd);
            const wrapped = `<details>
 <summary>Lock</summary>
 \xA7ENC_${makeUUID().slice(0, 6)}_${cipher}\xA7
</details>`;
            text = text.replace(m.text, wrapped);
            await this.app.vault.modify(file, text);
            processedCount++;
          }
          for (const selection of this.manualSelections) {
            await this.encryptManualSelection(selection.text, pwd);
            processedCount++;
          }
          new import_obsidian.Notice(`Successfully encrypted ${processedCount} item(s)`);
          if (this.currentMode === "scan") {
            this.matches = [];
          } else {
            this.searchResults = [];
          }
          this.selected.clear();
          this.manualSelections = [];
          this.render();
        } catch (error) {
          console.error("Encryption error:", error);
          new import_obsidian.Notice("Error during encryption. Please try again.");
        } finally {
          if (statusBar && statusBar.parentNode) {
            statusBar.remove();
          }
        }
      }
      /* -------- Decrypt (Unlock) -------- */
      async unlock() {
        const pwd = await this.getPassword(false);
        if (!pwd)
          return;
        const encRegex = /<details>\s*<summary>Lock<\/summary>\s*§ENC_[A-Za-z0-9]{6}_(.*?)§\s*<\/details>/g;
        const statusBar = this.containerEl.createEl("div", {
          cls: "pii-status",
          text: "Searching for encrypted content..."
        });
        try {
          let unlocked = 0;
          let filesProcessed = 0;
          const totalFiles = this.app.vault.getMarkdownFiles().length;
          for (const f of this.app.vault.getMarkdownFiles()) {
            filesProcessed++;
            statusBar.textContent = `Processing files... (${filesProcessed}/${totalFiles})`;
            let txt = await this.app.vault.cachedRead(f);
            const matches = [];
            let match;
            while ((match = encRegex.exec(txt)) !== null) {
              matches.push({
                full: match[0],
                cipher: match[1]
              });
            }
            if (matches.length === 0)
              continue;
            statusBar.textContent = `Decrypting content in ${f.basename}...`;
            let changed = false;
            for (const m of matches) {
              try {
                const plain = await decrypt(m.cipher, pwd);
                txt = txt.replace(m.full, plain);
                unlocked++;
                changed = true;
              } catch (e) {
                console.error("Decryption failed:", e);
                if (this.cachedPassword) {
                  this.clearCachedPassword();
                  new import_obsidian.Notice("Decryption failed. Password cache cleared.");
                }
              }
            }
            if (changed)
              await this.app.vault.modify(f, txt);
          }
          if (unlocked > 0) {
            statusBar.textContent = `Successfully decrypted ${unlocked} item(s)`;
            statusBar.addClass("pii-status-success");
            new import_obsidian.Notice(`Successfully decrypted ${unlocked} item(s)`);
          } else {
            statusBar.textContent = "No encrypted content found or incorrect password";
            new import_obsidian.Notice("No encrypted content found or incorrect password");
            this.clearCachedPassword();
          }
          setTimeout(() => {
            if (statusBar && statusBar.parentNode) {
              statusBar.remove();
            }
          }, 3e3);
        } catch (error) {
          console.error("Decryption error:", error);
          new import_obsidian.Notice("Error during decryption. Please try again.");
          if (statusBar && statusBar.parentNode) {
            statusBar.remove();
          }
        }
      }
    };
  }
});

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => PiiLockPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/settings.ts
var import_obsidian2 = require("obsidian");
var DEFAULT_SETTINGS = {
  patterns: ["\\d{6}-\\d{7}", "\\d{3}-\\d{4}-\\d{4}"],
  // Social Security Number-Phone Number Example
  patternMetadata: [
    { pattern: "\\d{6}-\\d{7}", source: "user", displayName: "User Pattern 1" },
    { pattern: "\\d{3}-\\d{4}-\\d{4}", source: "user", displayName: "User Pattern 2" }
  ],
  encryptAlgo: "AES-GCM",
  storedPassword: void 0,
  defaultPatterns: "",
  // Will be loaded from external file
  selectedCountries: []
  // No countries selected by default
};
async function loadDefaultPatternsFromFile(plugin) {
  try {
    const adapter = plugin.app.vault.adapter;
    const pluginDir = plugin.manifest.dir || "";
    const filePath = `${pluginDir}/default-patterns.ini`;
    const content = await adapter.read(filePath);
    return content;
  } catch (error) {
    console.warn("Could not load default-patterns.ini, using empty patterns:", error);
    return "";
  }
}
function parseDefaultPatterns(iniString) {
  const result = {};
  const lines = iniString.split("\n");
  let currentSection = "";
  const countryDisplayNames = {
    "US": "United States",
    "Korea": "South Korea",
    "Japan": "Japan",
    "Taiwan": "Taiwan",
    "India": "India",
    "None": "No Default Pattern"
  };
  for (const line of lines) {
    const trimmed = line.trim();
    if (!trimmed)
      continue;
    if (trimmed.startsWith("[") && trimmed.endsWith("]")) {
      currentSection = trimmed.slice(1, -1);
      result[currentSection] = {
        displayName: countryDisplayNames[currentSection] || currentSection,
        name: "",
        address: "",
        phone: ""
      };
    } else if (currentSection && trimmed.includes("=")) {
      const [key, ...valueParts] = trimmed.split("=");
      const value = valueParts.join("=");
      if (key === "name") {
        result[currentSection].name = value;
      } else if (key === "address") {
        result[currentSection].address = value;
      } else if (key === "phone") {
        result[currentSection].phone = value;
      }
    }
  }
  return result;
}
function serializeDefaultPatterns(patterns) {
  let result = "";
  for (const [country, pattern] of Object.entries(patterns)) {
    result += `[${country}]
`;
    result += `name=${pattern.name}
`;
    result += `address=${pattern.address}
`;
    result += `phone=${pattern.phone}
`;
    if (Object.keys(patterns).indexOf(country) < Object.keys(patterns).length - 1) {
      result += "\n";
    }
  }
  return result;
}
async function saveDefaultPatternsToFile(plugin, content) {
  try {
    const adapter = plugin.app.vault.adapter;
    const pluginDir = plugin.manifest.dir || "";
    const filePath = `${pluginDir}/default-patterns.ini`;
    await adapter.write(filePath, content);
  } catch (error) {
    console.error("Could not save default-patterns.ini:", error);
    new import_obsidian2.Notice("Failed to save default patterns file");
  }
}
async function updatePatternInINI(plugin, oldPattern, newPattern, source, defaultPatterns) {
  if (source !== "user") {
    const countryPattern = defaultPatterns[source];
    if (countryPattern) {
      let updated = false;
      if (countryPattern.name) {
        const namePatterns = countryPattern.name.split("|").filter((p) => p.trim());
        const nameIndex = namePatterns.indexOf(oldPattern);
        if (nameIndex !== -1) {
          namePatterns[nameIndex] = newPattern;
          countryPattern.name = namePatterns.join("|");
          updated = true;
        }
      }
      if (!updated && countryPattern.address) {
        const addressPatterns = countryPattern.address.split("|").filter((p) => p.trim());
        const addressIndex = addressPatterns.indexOf(oldPattern);
        if (addressIndex !== -1) {
          addressPatterns[addressIndex] = newPattern;
          countryPattern.address = addressPatterns.join("|");
          updated = true;
        }
      }
      if (!updated && countryPattern.phone) {
        const phonePatterns = countryPattern.phone.split("|").filter((p) => p.trim());
        const phoneIndex = phonePatterns.indexOf(oldPattern);
        if (phoneIndex !== -1) {
          phonePatterns[phoneIndex] = newPattern;
          countryPattern.phone = phonePatterns.join("|");
          updated = true;
        }
      }
      if (updated) {
        const serialized = serializeDefaultPatterns(defaultPatterns);
        await saveDefaultPatternsToFile(plugin, serialized);
      }
    }
  }
}
var PiiSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  async handlePasswordChange() {
    const { PwModal: PwModal2 } = await Promise.resolve().then(() => (init_PiiSidebarView(), PiiSidebarView_exports));
    const modal = new PwModal2(this.app, "Set Encryption Password", true);
    const password = await modal.wait();
    if (password) {
      const encoder = new TextEncoder();
      const data = encoder.encode(password);
      const hashBuffer = await crypto.subtle.digest("SHA-256", data);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      const hashHex = hashArray.map((b) => b.toString(16).padStart(2, "0")).join("");
      this.plugin.settings.storedPassword = hashHex;
      await this.plugin.saveSettings();
      new import_obsidian2.Notice("Password saved successfully");
    }
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    this.renderContent();
  }
  async renderContent() {
    const { containerEl } = this;
    containerEl.addClass("pii-settings-container");
    const patternsHeader = containerEl.createEl("details");
    patternsHeader.createEl("summary", { text: "Manage Patterns", cls: "pii-collapsible-header" });
    const patternsContainer = patternsHeader.createDiv("pii-patterns-container");
    const defaultPatternsContent = await loadDefaultPatternsFromFile(this.plugin);
    const defaultPatterns = parseDefaultPatterns(defaultPatternsContent);
    if (!this.plugin.settings.patternMetadata) {
      this.plugin.settings.patternMetadata = [];
      let userPatternCount = 1;
      for (const pattern of this.plugin.settings.patterns) {
        this.plugin.settings.patternMetadata.push({
          pattern,
          source: "user",
          displayName: `User Pattern ${userPatternCount}`
        });
        userPatternCount++;
      }
      await this.plugin.saveSettings();
    }
    this.plugin.settings.patternMetadata.forEach((patternMeta, idx) => {
      const s = new import_obsidian2.Setting(patternsContainer).setName(patternMeta.displayName).addText(
        (t) => t.setPlaceholder("\\d{6}-...").setValue(patternMeta.pattern).onChange(async (v) => {
          const oldPattern = patternMeta.pattern;
          this.plugin.settings.patterns[idx] = v;
          this.plugin.settings.patternMetadata[idx].pattern = v;
          await updatePatternInINI(this.plugin, oldPattern, v, patternMeta.source, defaultPatterns);
          await this.plugin.saveSettings();
        })
      ).addExtraButton(
        (btn) => btn.setIcon("trash").setTooltip("remove").onClick(async () => {
          this.plugin.settings.patterns.splice(idx, 1);
          this.plugin.settings.patternMetadata.splice(idx, 1);
          if (patternMeta.source !== "user") {
            const remainingCountryPatterns = this.plugin.settings.patternMetadata.filter((p) => p.source === patternMeta.source);
            if (remainingCountryPatterns.length === 0) {
              this.plugin.settings.selectedCountries = this.plugin.settings.selectedCountries.filter((c) => c !== patternMeta.source);
            }
          }
          await this.plugin.saveSettings();
          this.display();
        })
      );
      if (this.plugin.settings.patterns.length === 1) {
        const button = s.controlEl.querySelector("button");
        if (button)
          button.disabled = true;
      }
    });
    new import_obsidian2.Setting(patternsContainer).addButton(
      (btn) => btn.setButtonText("+").setTooltip("Add pattern").setCta().onClick(async () => {
        const userPatternCount = this.plugin.settings.patternMetadata.filter((p) => p.source === "user").length + 1;
        this.plugin.settings.patterns.push("");
        this.plugin.settings.patternMetadata.push({
          pattern: "",
          source: "user",
          displayName: `User Pattern ${userPatternCount}`
        });
        await this.plugin.saveSettings();
        this.display();
      })
    );
    containerEl.createEl("hr");
    containerEl.createEl("h3", { text: "Default Patterns" });
    const availableCountries = Object.keys(defaultPatterns).filter((c) => c !== "None");
    const selectedCountries = this.plugin.settings.selectedCountries;
    const selectedCountryNames = selectedCountries.map((c) => {
      var _a;
      return ((_a = defaultPatterns[c]) == null ? void 0 : _a.displayName) || c;
    }).join(", ");
    new import_obsidian2.Setting(containerEl).setName("Selected Countries").setDesc(selectedCountries.length > 0 ? selectedCountryNames : "No countries selected").addButton(
      (btn) => btn.setButtonText("Clear All").onClick(async () => {
        this.plugin.settings.selectedCountries = [];
        const userPatterns = this.plugin.settings.patternMetadata.filter((p) => p.source === "user");
        this.plugin.settings.patterns = userPatterns.map((p) => p.pattern);
        this.plugin.settings.patternMetadata = userPatterns;
        await this.plugin.saveSettings();
        new import_obsidian2.Notice("Cleared all selected countries");
        this.display();
      })
    );
    containerEl.createEl("h4", { text: "Add Country Patterns" });
    const countryButtonsContainer = containerEl.createDiv("pii-country-buttons");
    availableCountries.forEach((country) => {
      const pattern = defaultPatterns[country];
      const isSelected = this.plugin.settings.selectedCountries.includes(country);
      new import_obsidian2.Setting(countryButtonsContainer).setName(pattern.displayName).setDesc(`Add patterns for ${pattern.displayName}`).addButton(
        (btn) => btn.setButtonText(isSelected ? "Remove" : "Add").setClass(isSelected ? "mod-warning" : "mod-cta").onClick(async () => {
          const currentlySelected = this.plugin.settings.selectedCountries.includes(country);
          if (currentlySelected) {
            this.plugin.settings.selectedCountries = this.plugin.settings.selectedCountries.filter((c) => c !== country);
            const allCountryPatterns = [];
            if (pattern.name) {
              const namePatterns = pattern.name.split("|").filter((p) => p.trim());
              allCountryPatterns.push(...namePatterns);
            }
            if (pattern.address) {
              const addressPatterns = pattern.address.split("|").filter((p) => p.trim());
              allCountryPatterns.push(...addressPatterns);
            }
            if (pattern.phone) {
              const phonePatterns = pattern.phone.split("|").filter((p) => p.trim());
              allCountryPatterns.push(...phonePatterns);
            }
            this.plugin.settings.patterns = this.plugin.settings.patterns.filter((p) => !allCountryPatterns.includes(p));
            this.plugin.settings.patternMetadata = this.plugin.settings.patternMetadata.filter((p) => p.source !== country);
            new import_obsidian2.Notice(`Removed ${pattern.displayName} patterns`);
          } else {
            if (!this.plugin.settings.selectedCountries.includes(country)) {
              this.plugin.settings.selectedCountries.push(country);
            } else {
              new import_obsidian2.Notice(`${pattern.displayName} is already selected`);
              return;
            }
            if (pattern.name) {
              const namePatterns = pattern.name.split("|").filter((p) => p.trim());
              this.plugin.settings.patterns = [...this.plugin.settings.patterns, ...namePatterns];
              namePatterns.forEach((namePattern, index) => {
                this.plugin.settings.patternMetadata.push({
                  pattern: namePattern,
                  source: country,
                  displayName: `${country} Name ${index + 1}`
                });
              });
            }
            if (pattern.address) {
              const addressPatterns = pattern.address.split("|").filter((p) => p.trim());
              this.plugin.settings.patterns = [...this.plugin.settings.patterns, ...addressPatterns];
              addressPatterns.forEach((addressPattern, index) => {
                this.plugin.settings.patternMetadata.push({
                  pattern: addressPattern,
                  source: country,
                  displayName: `${country} Address ${index + 1}`
                });
              });
            }
            if (pattern.phone) {
              const phonePatterns = pattern.phone.split("|").filter((p) => p.trim());
              this.plugin.settings.patterns = [...this.plugin.settings.patterns, ...phonePatterns];
              phonePatterns.forEach((phonePattern, index) => {
                this.plugin.settings.patternMetadata.push({
                  pattern: phonePattern,
                  source: country,
                  displayName: `${country} Phone ${index + 1}`
                });
              });
            }
            new import_obsidian2.Notice(`Added ${pattern.displayName} patterns`);
          }
          await this.plugin.saveSettings();
          this.display();
        })
      );
    });
    containerEl.createEl("hr");
    containerEl.createEl("h3", { text: "Password Management" });
    const hasStoredPassword = !!this.plugin.settings.storedPassword;
    const statusText = hasStoredPassword ? "Password is currently stored" : "No password stored";
    const statusEl = containerEl.createEl("p", {
      text: statusText,
      cls: hasStoredPassword ? "pii-password-status-active" : "pii-password-status-inactive"
    });
    new import_obsidian2.Setting(containerEl).setName(hasStoredPassword ? "Change Password" : "Set Password").setDesc(hasStoredPassword ? "Update your encryption password" : "Set a password for encryption operations").addButton(
      (btn) => btn.setButtonText(hasStoredPassword ? "Change" : "Set").setCta().onClick(async () => {
        await this.handlePasswordChange();
        this.display();
      })
    );
    if (hasStoredPassword) {
      new import_obsidian2.Setting(containerEl).setName("Clear Stored Password").setDesc("Remove the stored password. You will be prompted for password on each operation.").addButton(
        (btn) => btn.setButtonText("Clear").setWarning().onClick(async () => {
          this.plugin.settings.storedPassword = void 0;
          await this.plugin.saveSettings();
          new import_obsidian2.Notice("Password cleared successfully");
          this.display();
        })
      );
    }
  }
};

// src/commands.ts
init_scanner();

// ui/ResultsModal.ts
var import_obsidian3 = require("obsidian");
var ResultsModal = class extends import_obsidian3.Modal {
  constructor(app, matches) {
    super(app);
    this.matches = matches;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("pii-modal");
    contentEl.createEl("h3", { text: `PII\xA0Matches (${this.matches.length})` });
    if (!this.matches.length) {
      contentEl.createEl("p", { text: "No PII found \u{1F389}" });
      return;
    }
    const list = contentEl.createEl("div", { cls: "pii-list" });
    this.matches.forEach((m, idx) => {
      const item = list.createEl("div", { cls: "pii-item" });
      const cb = item.createEl("input", { type: "checkbox" });
      cb.checked = true;
      item.createEl("span", {
        text: `${m.text}  \u2014  ${m.file.basename}:${m.line + 1}`,
        cls: "pii-text"
      });
      const goBtn = item.createEl("button", { text: "Open" });
      goBtn.onclick = () => this.openAtPosition(m);
    });
    contentEl.createEl("button", {
      text: "Close",
      cls: "mod-cta"
    }).onclick = () => this.close();
  }
  /** 같은 파일을 열어 커서 이동 */
  async openAtPosition(m) {
    const leaf = this.app.workspace.getLeaf(false);
    await leaf.openFile(m.file);
    const view = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (view)
      view.editor.setCursor({ line: m.line, ch: m.col });
  }
  onClose() {
    this.contentEl.empty();
  }
};

// src/commands.ts
function registerCommands(plugin) {
  plugin.addCommand({
    id: "pii-scan",
    name: "PII\xA0Scan",
    callback: async () => {
      const results = await scanVault(plugin);
      new ResultsModal(plugin.app, results).open();
    }
  });
  plugin.addCommand({
    id: "pii-lock",
    name: "PII\xA0Lock (encrypt)",
    callback: () => {
    }
  });
  plugin.addCommand({
    id: "pii-unlock",
    name: "PII\xA0Unlock (decrypt)",
    callback: () => {
    }
  });
}

// main.ts
init_PiiSidebarView();
var PiiLockPlugin = class extends import_obsidian4.Plugin {
  /* ──────────── Lifecycle ──────────── */
  async onload() {
    await this.loadSettings();
    this.registerView(
      VIEW_TYPE_PII,
      (leaf) => new PiiSidebarView(leaf, this)
    );
    this.addRibbonIcon("shield", "Lock and Find", () => this.activateSidebar());
    this.addSettingTab(new PiiSettingTab(this.app, this));
    registerCommands(this);
  }
  onunload() {
    this.app.workspace.detachLeavesOfType(VIEW_TYPE_PII);
  }
  /* ──────────── Helpers ──────────── */
  async activateSidebar() {
    const leaves = this.app.workspace.getLeavesOfType(VIEW_TYPE_PII);
    if (leaves.length > 0) {
      this.app.workspace.revealLeaf(leaves[0]);
      return;
    }
    const leaf = this.app.workspace.getLeaf("tab");
    await leaf.setViewState({
      type: VIEW_TYPE_PII,
      active: true
    });
    this.app.workspace.revealLeaf(leaf);
  }
  async loadSettings() {
    const saved = await this.loadData();
    this.settings = { ...DEFAULT_SETTINGS, ...saved };
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL3NjYW5uZXIudHMiLCAic3JjL2NyeXB0by50cyIsICJ1aS9QaWlTaWRlYmFyVmlldy50cyIsICJtYWluLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvY29tbWFuZHMudHMiLCAidWkvUmVzdWx0c01vZGFsLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgdHlwZSBQaWlMb2NrUGx1Z2luIGZyb20gXCIuLi9tYWluXCI7XG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIE1hdGNoSW5mbyB7XG4gIGZpbGU6IFRGaWxlOyAgICAgIC8vIFx1RDMwQ1x1Qzc3QyBcdUFDMURcdUNDQjRcbiAgbGluZTogbnVtYmVyOyAgICAgLy8gMFx1MjAxMWJhc2VkIFx1RDU4OSBcdUJDODhcdUQ2MzhcbiAgY29sOiBudW1iZXI7ICAgICAgLy8gMFx1MjAxMWJhc2VkIFx1QzVGNCBcdUJDODhcdUQ2MzhcbiAgdGV4dDogc3RyaW5nOyAgICAgLy8gXHVCOUU0XHVDRTZEXHVCNDFDIFx1QkIzOFx1Qzc5MFx1QzVGNFxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2NhblZhdWx0KHBsdWdpbjogUGlpTG9ja1BsdWdpbik6IFByb21pc2U8TWF0Y2hJbmZvW10+IHtcbiAgY29uc3QgdmF1bHQgPSBwbHVnaW4uYXBwLnZhdWx0O1xuICBjb25zdCBwYXR0ZXJucyA9IHBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJucy5tYXAocCA9PiBuZXcgUmVnRXhwKHAsIFwiZ1wiKSk7XG4gIGNvbnN0IHJlc3VsdHM6IE1hdGNoSW5mb1tdID0gW107XG5cbiAgZm9yIChjb25zdCBmaWxlIG9mIHZhdWx0LmdldE1hcmtkb3duRmlsZXMoKSkge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB2YXVsdC5jYWNoZWRSZWFkKGZpbGUpO1xuICAgIGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdChcIlxcblwiKTtcblxuICAgIGxpbmVzLmZvckVhY2goKGxpbmVUZXh0LCBsaW5lTnVtKSA9PiB7XG4gICAgICBwYXR0ZXJucy5mb3JFYWNoKHJlID0+IHtcbiAgICAgICAgZm9yIChjb25zdCBtIG9mIGxpbmVUZXh0Lm1hdGNoQWxsKHJlKSkge1xuICAgICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgbGluZTogbGluZU51bSxcbiAgICAgICAgICAgIGNvbDogbS5pbmRleCA/PyAwLFxuICAgICAgICAgICAgdGV4dDogbVswXSxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHM7ICAgIC8vIFVJKFJlc3VsdHNNb2RhbCBcdUI0RjEpXHVDNUQwXHVDMTFDIFx1Qzc5MFx1QzcyMFx1Qjg2RFx1QUM4QyBcdUMwQUNcdUM2QTlcbn0iLCAiLy8gc3JjL2NyeXB0by50c1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlcml2ZUtleShwd2Q6IHN0cmluZyk6IFByb21pc2U8Q3J5cHRvS2V5PiB7XG4gIGNvbnN0IGVuYyA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICBjb25zdCBrZXlNYXRlcmlhbCA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuaW1wb3J0S2V5KFxuICAgIFwicmF3XCIsXG4gICAgZW5jLmVuY29kZShwd2QpLFxuICAgIHsgbmFtZTogXCJQQktERjJcIiB9LFxuICAgIGZhbHNlLFxuICAgIFtcImRlcml2ZUtleVwiXVxuICApO1xuICByZXR1cm4gY3J5cHRvLnN1YnRsZS5kZXJpdmVLZXkoXG4gICAge1xuICAgICAgbmFtZTogXCJQQktERjJcIixcbiAgICAgIHNhbHQ6IGVuYy5lbmNvZGUoXCJwaWktc2FsdFwiKSxcbiAgICAgIGl0ZXJhdGlvbnM6IDUwXzAwMCxcbiAgICAgIGhhc2g6IFwiU0hBLTI1NlwiLFxuICAgIH0sXG4gICAga2V5TWF0ZXJpYWwsXG4gICAgeyBuYW1lOiBcIkFFUy1HQ01cIiwgbGVuZ3RoOiAyNTYgfSxcbiAgICBmYWxzZSxcbiAgICBbXCJlbmNyeXB0XCIsIFwiZGVjcnlwdFwiXVxuICApO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZW5jcnlwdCh0ZXh0OiBzdHJpbmcsIHB3ZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgaXYgPSBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50OEFycmF5KDEyKSk7XG4gIGNvbnN0IGtleSA9IGF3YWl0IGRlcml2ZUtleShwd2QpO1xuICBjb25zdCBlbmMgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUodGV4dCk7XG4gIGNvbnN0IGJ1ZiA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZW5jcnlwdCh7IG5hbWU6IFwiQUVTLUdDTVwiLCBpdiB9LCBrZXksIGVuYyk7XG4gIHJldHVybiBgJHtCdWZmZXIuZnJvbShpdikudG9TdHJpbmcoXCJiYXNlNjRcIil9LiR7QnVmZmVyLmZyb20oYnVmKS50b1N0cmluZyhcImJhc2U2NFwiKX1gO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVjcnlwdChkYXRhOiBzdHJpbmcsIHB3ZDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgW2l2QjY0LCBidWZCNjRdID0gZGF0YS5zcGxpdChcIi5cIik7XG4gIGNvbnN0IGl2ID0gVWludDhBcnJheS5mcm9tKEJ1ZmZlci5mcm9tKGl2QjY0LCBcImJhc2U2NFwiKSk7XG4gIGNvbnN0IGJ1ZiA9IEJ1ZmZlci5mcm9tKGJ1ZkI2NCwgXCJiYXNlNjRcIik7XG4gIGNvbnN0IGtleSA9IGF3YWl0IGRlcml2ZUtleShwd2QpO1xuICBjb25zdCBkZWMgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmRlY3J5cHQoeyBuYW1lOiBcIkFFUy1HQ01cIiwgaXYgfSwga2V5LCBidWYpO1xuICByZXR1cm4gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGRlYyk7XG59XG4iLCAiaW1wb3J0IHtcbiAgSXRlbVZpZXcsIFdvcmtzcGFjZUxlYWYsIE1hcmtkb3duVmlldyxcbiAgTW9kYWwsIFNldHRpbmcsIE5vdGljZVxufSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB0eXBlIFBpaUxvY2tQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcbmltcG9ydCB7IHNjYW5WYXVsdCwgTWF0Y2hJbmZvIH0gZnJvbSBcIi4uL3NyYy9zY2FubmVyXCI7XG5pbXBvcnQgeyBlbmNyeXB0LCBkZWNyeXB0IH0gZnJvbSBcIi4uL3NyYy9jcnlwdG9cIjtcblxuZXhwb3J0IGNvbnN0IFZJRVdfVFlQRV9QSUkgPSBcInBpaS1zaWRlYmFyLXZpZXdcIjtcbmNvbnN0IG1ha2VVVUlEID0gKCkgPT5cbiAgKGNyeXB0byBhcyBhbnkpLnJhbmRvbVVVSUQ/LigpID8/XG4gIERhdGUubm93KCkudG9TdHJpbmcoMzYpICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMiwgMTApO1xuXG4vKiBQYXNzd29yZCBNb2RhbCB3aXRoIGltcHJvdmVkIFVJICovXG5leHBvcnQgY2xhc3MgUHdNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgcHJpdmF0ZSBfcmVzb2x2ZSE6ICh2OiBzdHJpbmcgfCBudWxsKSA9PiB2b2lkO1xuICBjb25zdHJ1Y3RvcihhcHA6IGFueSwgcHJpdmF0ZSB0aXRsZTogc3RyaW5nLCBwcml2YXRlIGlzRW5jcnlwdDogYm9vbGVhbiA9IGZhbHNlKSB7IHN1cGVyKGFwcCk7IH1cblxuICBvbk9wZW4oKSB7XG4gICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgIGNvbnRhaW5lckVsLmFkZENsYXNzKFwicGlpLW1vZGFsXCIpO1xuICAgIFxuICAgIC8vIENyZWF0ZSBhIGNvbnRlbnQgY29udGFpbmVyIHdpdGggcHJvcGVyIHNwYWNpbmdcbiAgICBjb25zdCBjb250ZW50Q29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJwaWktbW9kYWwtY29udGVudFwiXG4gICAgfSk7XG4gICAgXG4gICAgLy8gQWRkIHRpdGxlIHdpdGggaWNvblxuICAgIGNvbnN0IHRpdGxlRWwgPSBjb250ZW50Q29udGFpbmVyLmNyZWF0ZUVsKFwiaDNcIiwge1xuICAgICAgY2xzOiBcInBpaS1tb2RhbC10aXRsZVwiXG4gICAgfSk7XG4gICAgY29uc3QgaWNvbiA9IHRoaXMuaXNFbmNyeXB0ID8gXCJcdUQ4M0RcdUREMTJcIiA6IFwiXHVEODNEXHVERDEzXCI7XG4gICAgdGl0bGVFbC5pbm5lckhUTUwgPSBgJHtpY29ufSAke3RoaXMudGl0bGV9YDtcbiAgICBcbiAgICAvLyBBZGQgZGVzY3JpcHRpb25cbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHRoaXMuaXNFbmNyeXB0IFxuICAgICAgPyBcIkVudGVyIGEgcGFzc3dvcmQgdG8gZW5jcnlwdCB5b3VyIHNlbnNpdGl2ZSBpbmZvcm1hdGlvbi4gUmVtZW1iZXIgdGhpcyBwYXNzd29yZCBhcyB5b3UnbGwgbmVlZCBpdCB0byBkZWNyeXB0IGxhdGVyLlwiXG4gICAgICA6IFwiRW50ZXIgeW91ciBwYXNzd29yZCB0byBkZWNyeXB0IHRoZSBwcm90ZWN0ZWQgaW5mb3JtYXRpb24uXCI7XG4gICAgXG4gICAgY29udGVudENvbnRhaW5lci5jcmVhdGVFbChcInBcIiwgeyBcbiAgICAgIHRleHQ6IGRlc2NyaXB0aW9uLFxuICAgICAgY2xzOiBcInBpaS1tb2RhbC1kZXNjcmlwdGlvblwiXG4gICAgfSk7XG4gIFxuICAgIGxldCBwdyA9IFwiXCI7XG4gICAgbGV0IHNob3dQYXNzd29yZCA9IGZhbHNlO1xuICAgIFxuICAgIC8vIENyZWF0ZSBmb3JtIGNvbnRhaW5lclxuICAgIGNvbnN0IGZvcm1Db250YWluZXIgPSBjb250ZW50Q29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IFwicGlpLW1vZGFsLWZvcm1cIlxuICAgIH0pO1xuICAgIFxuICAgIC8vIFBhc3N3b3JkIGZpZWxkIGNvbnRhaW5lclxuICAgIGNvbnN0IHB3Q29udGFpbmVyID0gZm9ybUNvbnRhaW5lci5jcmVhdGVEaXYoe1xuICAgICAgY2xzOiBcInBpaS1wYXNzd29yZC1jb250YWluZXJcIlxuICAgIH0pO1xuICAgIFxuICAgIC8vIFBhc3N3b3JkIGxhYmVsXG4gICAgcHdDb250YWluZXIuY3JlYXRlRWwoXCJsYWJlbFwiLCB7XG4gICAgICB0ZXh0OiBcIlBhc3N3b3JkXCIsXG4gICAgICBjbHM6IFwicGlpLWlucHV0LWxhYmVsXCJcbiAgICB9KTtcbiAgICBcbiAgICAvLyBQYXNzd29yZCBpbnB1dCB3cmFwcGVyIGZvciBwb3NpdGlvbmluZyB0aGUgdG9nZ2xlIGJ1dHRvblxuICAgIGNvbnN0IHB3SW5wdXRXcmFwcGVyID0gcHdDb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgIGNsczogXCJwaWktaW5wdXQtd3JhcHBlclwiXG4gICAgfSk7XG4gICAgXG4gICAgLy8gUGFzc3dvcmQgaW5wdXRcbiAgICBjb25zdCBwd0lucHV0ID0gcHdJbnB1dFdyYXBwZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG4gICAgICB0eXBlOiBcInBhc3N3b3JkXCIsXG4gICAgICBwbGFjZWhvbGRlcjogdGhpcy5pc0VuY3J5cHQgPyBcIkNyZWF0ZSBhIHN0cm9uZyBwYXNzd29yZFwiIDogXCJFbnRlciB5b3VyIHBhc3N3b3JkXCIsXG4gICAgICBjbHM6IFwicGlpLXBhc3N3b3JkLWlucHV0XCJcbiAgICB9KTtcbiAgICBcbiAgICBwd0lucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xuICAgICAgcHcgPSAoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWU7XG4gICAgfSk7XG4gICAgXG4gICAgLy8gRm9jdXMgb24gdGhlIGlucHV0IHdoZW4gbW9kYWwgb3BlbnNcbiAgICBwd0lucHV0LmZvY3VzKCk7XG4gICAgXG4gICAgLy8gSGFuZGxlIEVudGVyIGtleVxuICAgIHB3SW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgZSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICBpZiAodGhpcy5pc0VuY3J5cHQpIHtcbiAgICAgICAgICB0aGlzLnZhbGlkYXRlQW5kU3VibWl0KHB3LCBjb25maXJtUHcpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc3VibWl0KHB3KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIFxuICAgIC8vIEFkZCBzaG93L2hpZGUgcGFzc3dvcmQgdG9nZ2xlXG4gICAgY29uc3QgdG9nZ2xlQnRuID0gcHdJbnB1dFdyYXBwZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiBcInBpaS1wYXNzd29yZC10b2dnbGVcIixcbiAgICAgIHRleHQ6IFwiXHVEODNEXHVEQzQxXHVGRTBGXCIgLy8gRXllIGljb25cbiAgICB9KTtcbiAgICBcbiAgICB0b2dnbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBzaG93UGFzc3dvcmQgPSAhc2hvd1Bhc3N3b3JkO1xuICAgICAgcHdJbnB1dC50eXBlID0gc2hvd1Bhc3N3b3JkID8gXCJ0ZXh0XCIgOiBcInBhc3N3b3JkXCI7XG4gICAgICB0b2dnbGVCdG4udGV4dENvbnRlbnQgPSBzaG93UGFzc3dvcmQgPyBcIlx1RDgzRFx1REM0MVx1RkUwRlx1MjAwRFx1RDgzRFx1RERFOFx1RkUwRlwiIDogXCJcdUQ4M0RcdURDNDFcdUZFMEZcIjsgLy8gRXllIHdpdGggc2xhc2ggd2hlbiBoaWRkZW5cbiAgICB9KTtcbiAgICBcbiAgICAvLyBBZGQgY29uZmlybWF0aW9uIGZpZWxkIGlmIGVuY3J5cHRpbmdcbiAgICBsZXQgY29uZmlybVB3ID0gXCJcIjtcbiAgICBsZXQgY29uZmlybUlucHV0OiBIVE1MSW5wdXRFbGVtZW50IHwgbnVsbCA9IG51bGw7XG4gICAgaWYgKHRoaXMuaXNFbmNyeXB0KSB7XG4gICAgICBjb25zdCBjb25maXJtQ29udGFpbmVyID0gZm9ybUNvbnRhaW5lci5jcmVhdGVEaXYoe1xuICAgICAgICBjbHM6IFwicGlpLXBhc3N3b3JkLWNvbnRhaW5lclwiXG4gICAgICB9KTtcbiAgICAgIGNvbmZpcm1Db250YWluZXIuY3JlYXRlRWwoXCJsYWJlbFwiLCB7XG4gICAgICAgIHRleHQ6IFwiQ29uZmlybSBQYXNzd29yZFwiLFxuICAgICAgICBjbHM6IFwicGlpLWlucHV0LWxhYmVsXCJcbiAgICAgIH0pO1xuICAgICAgY29uc3QgY29uZmlybUlucHV0V3JhcHBlciA9IGNvbmZpcm1Db250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgY2xzOiBcInBpaS1pbnB1dC13cmFwcGVyXCJcbiAgICAgIH0pO1xuICAgICAgY29uZmlybUlucHV0ID0gY29uZmlybUlucHV0V3JhcHBlci5jcmVhdGVFbChcImlucHV0XCIsIHtcbiAgICAgICAgdHlwZTogXCJwYXNzd29yZFwiLFxuICAgICAgICBwbGFjZWhvbGRlcjogXCJDb25maXJtIHlvdXIgcGFzc3dvcmRcIixcbiAgICAgICAgY2xzOiBcInBpaS1wYXNzd29yZC1pbnB1dFwiXG4gICAgICB9KTtcbiAgICAgIGNvbmZpcm1JbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcbiAgICAgICAgY29uZmlybVB3ID0gKGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBFbnRlciBrZXkgZm9yIGNvbmZpcm1hdGlvbiBmaWVsZFxuICAgICAgY29uZmlybUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGUgPT4ge1xuICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgIHRoaXMudmFsaWRhdGVBbmRTdWJtaXQocHcsIGNvbmZpcm1Qdyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBBZGQgc2hvdy9oaWRlIHBhc3N3b3JkIHRvZ2dsZSBmb3IgY29uZmlybWF0aW9uXG4gICAgICBjb25zdCBjb25maXJtVG9nZ2xlQnRuID0gY29uZmlybUlucHV0V3JhcHBlci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XG4gICAgICAgIGNsczogXCJwaWktcGFzc3dvcmQtdG9nZ2xlXCIsXG4gICAgICAgIHRleHQ6IFwiXHVEODNEXHVEQzQxXHVGRTBGXCIgLy8gRXllIGljb25cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25maXJtVG9nZ2xlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHNob3dQYXNzd29yZCA9ICFzaG93UGFzc3dvcmQ7XG4gICAgICAgIGlmIChjb25maXJtSW5wdXQpIHtcbiAgICAgICAgICBjb25maXJtSW5wdXQudHlwZSA9IHNob3dQYXNzd29yZCA/IFwidGV4dFwiIDogXCJwYXNzd29yZFwiO1xuICAgICAgICB9XG4gICAgICAgIGNvbmZpcm1Ub2dnbGVCdG4udGV4dENvbnRlbnQgPSBzaG93UGFzc3dvcmQgPyBcIlx1RDgzRFx1REM0MVx1RkUwRlx1MjAwRFx1RDgzRFx1RERFOFx1RkUwRlwiIDogXCJcdUQ4M0RcdURDNDFcdUZFMEZcIjtcbiAgICAgICAgcHdJbnB1dC50eXBlID0gc2hvd1Bhc3N3b3JkID8gXCJ0ZXh0XCIgOiBcInBhc3N3b3JkXCI7XG4gICAgICAgIHRvZ2dsZUJ0bi50ZXh0Q29udGVudCA9IHNob3dQYXNzd29yZCA/IFwiXHVEODNEXHVEQzQxXHVGRTBGXHUyMDBEXHVEODNEXHVEREU4XHVGRTBGXCIgOiBcIlx1RDgzRFx1REM0MVx1RkUwRlwiO1xuICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEJ1dHRvbiBjb250YWluZXJcbiAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50Q29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgICBjbHM6IFwicGlpLW1vZGFsLWJ1dHRvbnNcIlxuICAgIH0pO1xuICAgIFxuICAgIC8vIENhbmNlbCBidXR0b25cbiAgICBjb25zdCBjYW5jZWxCdG4gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgdGV4dDogXCJDYW5jZWxcIixcbiAgICAgIGNsczogXCJwaWktYnRuLXNlY29uZGFyeVwiXG4gICAgfSk7XG4gICAgXG4gICAgY2FuY2VsQnRuLm9uY2xpY2sgPSAoKSA9PiB0aGlzLmNsb3NlKCk7XG4gICAgXG4gICAgLy8gU3VibWl0IGJ1dHRvblxuICAgIGNvbnN0IGFjdGlvblRleHQgPSB0aGlzLmlzRW5jcnlwdCA/IFwiRW5jcnlwdFwiIDogXCJEZWNyeXB0XCI7XG4gICAgY29uc3Qgc3VibWl0QnRuID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgIHRleHQ6IGFjdGlvblRleHQsXG4gICAgICBjbHM6IFwicGlpLWJ0bi1wcmltYXJ5XCJcbiAgICB9KTtcbiAgICBcbiAgICBzdWJtaXRCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmlzRW5jcnlwdCkge1xuICAgICAgICB0aGlzLnZhbGlkYXRlQW5kU3VibWl0KHB3LCBjb25maXJtUHcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zdWJtaXQocHcpO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIHZhbGlkYXRlQW5kU3VibWl0KHB3OiBzdHJpbmcsIGNvbmZpcm1Qdzogc3RyaW5nKSB7XG4gICAgaWYgKCFwdykge1xuICAgICAgbmV3IE5vdGljZShcIlBsZWFzZSBlbnRlciBhIHBhc3N3b3JkXCIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICBpZiAodGhpcy5pc0VuY3J5cHQgJiYgcHcgIT09IGNvbmZpcm1Qdykge1xuICAgICAgbmV3IE5vdGljZShcIlBhc3N3b3JkcyBkbyBub3QgbWF0Y2hcIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIHRoaXMuc3VibWl0KHB3KTtcbiAgfVxuXG4gIHByaXZhdGUgc3VibWl0KHB3OiBzdHJpbmcpIHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gICAgdGhpcy5fcmVzb2x2ZShwdyB8fCBudWxsKTtcbiAgfVxuXG4gIG9uQ2xvc2UoKSB7IHRoaXMuY29udGVudEVsLmVtcHR5KCk7IH1cbiAgXG4gIHdhaXQoKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgdGhpcy5vcGVuKCk7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlcyA9PiAodGhpcy5fcmVzb2x2ZSA9IHJlcykpO1xuICB9XG59XG5cblxuLyogXHUyNTAwXHUyNTAwIFx1QzBBQ1x1Qzc3NFx1QjREQ1x1QkMxNCBcdUJERjAgXHUyNTAwICovXG5leHBvcnQgY2xhc3MgUGlpU2lkZWJhclZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XG4gIHByaXZhdGUgbWF0Y2hlczogTWF0Y2hJbmZvW10gPSBbXTtcbiAgcHJpdmF0ZSBzZWFyY2hSZXN1bHRzOiBNYXRjaEluZm9bXSA9IFtdO1xuICBwcml2YXRlIG1hbnVhbFNlbGVjdGlvbnM6IHt0ZXh0OiBzdHJpbmcsIGlkOiBzdHJpbmd9W10gPSBbXTtcbiAgcHJpdmF0ZSBzZWxlY3RlZDogU2V0PG51bWJlcj4gPSBuZXcgU2V0KCk7XG4gIHByaXZhdGUgY2FjaGVkUGFzc3dvcmQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIGN1cnJlbnRNb2RlOiAnc2NhbicgfCAnc2VhcmNoJyA9ICdzY2FuJztcbiAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcHJpdmF0ZSBwbHVnaW46UGlpTG9ja1BsdWdpbil7c3VwZXIobGVhZik7fVxuICBnZXRWaWV3VHlwZSgpe3JldHVybiBWSUVXX1RZUEVfUElJO31cbiAgZ2V0RGlzcGxheVRleHQoKXtyZXR1cm4gXCJMb2NrIGFuZCBGaW5kXCI7fVxuICBnZXRJY29uKCl7cmV0dXJuIFwic2hpZWxkXCI7fVxuXG4gIGFzeW5jIG9uT3Blbigpe1xuICAgIGNvbnN0IGU9dGhpcy5jb250YWluZXJFbDsgZS5lbXB0eSgpO1xuICAgIFxuICAgIC8vIFNldCB1cCBnbG9iYWwgdGV4dCBzZWxlY3Rpb24gbGlzdGVuZXJzIGZvciBkcmFnIGFuZCBkcm9wXG4gICAgdGhpcy5zZXR1cFRleHRTZWxlY3Rpb25EcmFnRHJvcCgpO1xuXG4gICAgLy8gTW9kZSB0b2dnbGUgYnV0dG9uc1xuICAgIGNvbnN0IG1vZGVDb250YWluZXIgPSBlLmNyZWF0ZUVsKFwiZGl2XCIsIHtjbHM6IFwicGlpLW1vZGUtdG9nZ2xlXCJ9KTtcbiAgICBjb25zdCBzY2FuTW9kZUJ0biA9IG1vZGVDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuICAgICAgY2xzOiB0aGlzLmN1cnJlbnRNb2RlID09PSAnc2NhbicgPyBcInBpaS1idG4tcHJpbWFyeVwiIDogXCJwaWktYnRuLXNlY29uZGFyeVwiLFxuICAgICAgdGV4dDogXCJTY2FuIE1vZGVcIlxuICAgIH0pO1xuICAgIGNvbnN0IHNlYXJjaE1vZGVCdG4gPSBtb2RlQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgIGNsczogdGhpcy5jdXJyZW50TW9kZSA9PT0gJ3NlYXJjaCcgPyBcInBpaS1idG4tcHJpbWFyeVwiIDogXCJwaWktYnRuLXNlY29uZGFyeVwiLCBcbiAgICAgIHRleHQ6IFwiU2VhcmNoIE1vZGVcIlxuICAgIH0pO1xuXG4gICAgc2Nhbk1vZGVCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgIHRoaXMuY3VycmVudE1vZGUgPSAnc2Nhbic7XG4gICAgICBzY2FuTW9kZUJ0bi5jbGFzc05hbWUgPSBcInBpaS1idG4tcHJpbWFyeVwiO1xuICAgICAgc2VhcmNoTW9kZUJ0bi5jbGFzc05hbWUgPSBcInBpaS1idG4tc2Vjb25kYXJ5XCI7XG4gICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH07XG5cbiAgICBzZWFyY2hNb2RlQnRuLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICB0aGlzLmN1cnJlbnRNb2RlID0gJ3NlYXJjaCc7XG4gICAgICBzY2FuTW9kZUJ0bi5jbGFzc05hbWUgPSBcInBpaS1idG4tc2Vjb25kYXJ5XCI7XG4gICAgICBzZWFyY2hNb2RlQnRuLmNsYXNzTmFtZSA9IFwicGlpLWJ0bi1wcmltYXJ5XCI7XG4gICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH07XG5cbiAgICAvLyBTY2FuIGNvbnRyb2xzIChvbmx5IHNob3cgaW4gc2NhbiBtb2RlKVxuICAgIGNvbnN0IHNjYW5Db250cm9scyA9IGUuY3JlYXRlRWwoXCJkaXZcIiwge2NsczogXCJwaWktc2Nhbi1jb250cm9sc1wifSk7XG4gICAgXG4gICAgLy8gU2NhbiBidXR0b24gd2l0aCBpY29uXG4gICAgY29uc3Qgc2NhbiA9IHNjYW5Db250cm9scy5jcmVhdGVFbChcImJ1dHRvblwiLCB7Y2xzOiBcInBpaS1idG4tcHJpbWFyeSBwaWktYnRuLWhhbGZcIn0pO1xuICAgIHNjYW4uaW5uZXJIVE1MID0gJzxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiPjxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTE1LjUsMTJDMTgsMTIgMjAsMTQgMjAsMTYuNUMyMCwxNy4zOCAxOS43NSwxOC4yMSAxOS4zMSwxOC45TDIyLjM5LDIyTDIxLDIzLjM5TDE3Ljg4LDIwLjMyQzE3LjE5LDIwLjc1IDE2LjM3LDIxIDE1LjUsMjFDMTMsMjEgMTEsMTkgMTEsMTYuNUMxMSwxNCAxMywxMiAxNS41LDEyTTE1LjUsMTRBMi41LDIuNSAwIDAsMCAxMywxNi41QTIuNSwyLjUgMCAwLDAgMTUuNSwxOUEyLjUsMi41IDAgMCwwIDE4LDE2LjVBMi41LDIuNSAwIDAsMCAxNS41LDE0TTUsM0gxOUMyMC4xMSwzIDIxLDMuODkgMjEsNVYxMy4wM0MyMC41LDEyLjIzIDE5LjgxLDExLjU0IDE5LDExVjVINVYxOUg5LjVDOS44MSwxOS43NSAxMC4yNiwyMC40MiAxMC44MSwyMUg1QzMuODksMjEgMywyMC4xMSAzLDE5VjVDMywzLjg5IDMuODksMyA1LDNNNyw3SDE3VjlIN1Y3TTcsMTFIMTIuMDNDMTEuMjMsMTEuNSAxMC41NCwxMi4xOSAxMCwxM0g3VjExTTcsMTVIOS4xN0M5LjA2LDE1LjUgOSwxNiA5LDE2LjVWMTdIN1YxNVpcIj48L3BhdGg+PC9zdmc+IFNjYW4gVmF1bHQnO1xuICAgIFxuICAgIC8vIENsZWFyIGJ1dHRvbiB3aXRoIGljb25cbiAgICBjb25zdCBjbGVhciA9IHNjYW5Db250cm9scy5jcmVhdGVFbChcImJ1dHRvblwiLCB7Y2xzOiBcInBpaS1idG4tc2Vjb25kYXJ5IHBpaS1idG4taGFsZlwifSk7XG4gICAgY2xlYXIuaW5uZXJIVE1MID0gJzxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiPjxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTE5LDRIMTUuNUwxNC41LDNIOS41TDguNSw0SDVWNkgxOU02LDE5QTIsMiAwIDAsMCA4LDIxSDE2QTIsMiAwIDAsMCAxOCwxOVY3SDZWMTlaXCI+PC9wYXRoPjwvc3ZnPiBDbGVhcic7XG4gICAgXG4gICAgc2Nhbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgc2Nhbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICBzY2FuLmlubmVySFRNTCA9ICc8c3ZnIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIj48cGF0aCBmaWxsPVwiY3VycmVudENvbG9yXCIgZD1cIk0xMiw0VjJBMTAsMTAgMCAwLDAgMiwxMkg0QTgsOCAwIDAsMSAxMiw0WlwiPjxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9XCJ0cmFuc2Zvcm1cIiBhdHRyaWJ1dGVUeXBlPVwiWE1MXCIgdHlwZT1cInJvdGF0ZVwiIGR1cj1cIjFzXCIgZnJvbT1cIjAgMTIgMTJcIiB0bz1cIjM2MCAxMiAxMlwiIHJlcGVhdENvdW50PVwiaW5kZWZpbml0ZVwiIC8+PC9wYXRoPjwvc3ZnPiBTY2FubmluZy4uLic7XG4gICAgICB0aGlzLm1hdGNoZXMgPSBhd2FpdCBzY2FuVmF1bHQodGhpcy5wbHVnaW4pO1xuICAgICAgdGhpcy5zZWxlY3RlZC5jbGVhcigpO1xuICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgIHNjYW4uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgIHNjYW4uaW5uZXJIVE1MID0gJzxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiPjxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTE1LjUsMTJDMTgsMTIgMjAsMTQgMjAsMTYuNUMyMCwxNy4zOCAxOS43NSwxOC4yMSAxOS4zMSwxOC45TDIyLjM5LDIyTDIxLDIzLjM5TDE3Ljg4LDIwLjMyQzE3LjE5LDIwLjc1IDE2LjM3LDIxIDE1LjUsMjFDMTMsMjEgMTEsMTkgMTEsMTYuNUMxMSwxNCAxMywxMiAxNS41LDEyTTE1LjUsMTRBMi41LDIuNSAwIDAsMCAxMywxNi41QTIuNSwyLjUgMCAwLDAgMTUuNSwxOUEyLjUsMi41IDAgMCwwIDE4LDE2LjVBMi41LDIuNSAwIDAsMCAxNS41LDE0TTUsM0gxOUMyMC4xMSwzIDIxLDMuODkgMjEsNVYxMy4wM0MyMC41LDEyLjIzIDE5LjgxLDExLjU0IDE5LDExVjVINVYxOUg5LjVDOS44MSwxOS43NSAxMC4yNiwyMC40MiAxMC44MSwyMUg1QzMuODksMjEgMywyMC4xMSAzLDE5VjVDMywzLjg5IDMuODksMyA1LDNNNyw3SDE3VjlIN1Y3TTcsMTFIMTIuMDNDMTEuMjMsMTEuNSAxMC41NCwxMi4xOSAxMCwxM0g3VjExTTcsMTVIOS4xN0M5LjA2LDE1LjUgOSwxNiA5LDE2LjVWMTdIN1YxNVpcIj48L3BhdGg+PC9zdmc+IFNjYW4gVmF1bHQnO1xuICAgIH07XG4gICAgXG4gICAgY2xlYXIub25jbGljayA9ICgpID0+IHtcbiAgICAgIHRoaXMubWF0Y2hlcyA9IFtdO1xuICAgICAgdGhpcy5zZWFyY2hSZXN1bHRzID0gW107XG4gICAgICB0aGlzLm1hbnVhbFNlbGVjdGlvbnMgPSBbXTtcbiAgICAgIHRoaXMuc2VsZWN0ZWQuY2xlYXIoKTtcbiAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfTtcblxuICAgIC8vIFNlYXJjaCBpbnB1dCAob25seSBzaG93IGluIHNlYXJjaCBtb2RlKVxuICAgIGNvbnN0IHNlYXJjaENvbnRhaW5lciA9IGUuY3JlYXRlRWwoXCJkaXZcIiwge2NsczogXCJwaWktc2VhcmNoLWNvbnRhaW5lclwifSk7XG4gICAgY29uc3Qgc2VhcmNoSW5wdXQgPSBzZWFyY2hDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG4gICAgICB0eXBlOiBcInRleHRcIixcbiAgICAgIHBsYWNlaG9sZGVyOiBcIlNlYXJjaCBmb3IgdGV4dCB0byBlbmNyeXB0Li4uXCIsXG4gICAgICBjbHM6IFwicGlpLXNlYXJjaC1pbnB1dFwiXG4gICAgfSk7XG4gICAgXG4gICAgY29uc3Qgc2VhcmNoQnRuID0gc2VhcmNoQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtjbHM6IFwicGlpLWJ0bi1wcmltYXJ5XCJ9KTtcbiAgICBzZWFyY2hCdG4uaW5uZXJIVE1MID0gJzxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiPjxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTE1LjUsMTJDMTgsMTIgMjAsMTQgMjAsMTYuNUMyMCwxNy4zOCAxOS43NSwxOC4yMSAxOS4zMSwxOC45TDIyLjM5LDIyTDIxLDIzLjM5TDE3Ljg4LDIwLjMyQzE3LjE5LDIwLjc1IDE2LjM3LDIxIDE1LjUsMjFDMTMsMjEgMTEsMTkgMTEsMTYuNUMxMSwxNCAxMywxMiAxNS41LDEyTTE1LjUsMTRBMi41LDIuNSAwIDAsMCAxMywxNi41QTIuNSwyLjUgMCAwLDAgMTUuNSwxOUEyLjUsMi41IDAgMCwwIDE4LDE2LjVBMi41LDIuNSAwIDAsMCAxNS41LDE0WlwiPjwvcGF0aD48L3N2Zz4gU2VhcmNoJztcblxuICAgIHNlYXJjaEJ0bi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcXVlcnkgPSBzZWFyY2hJbnB1dC52YWx1ZS50cmltKCk7XG4gICAgICBpZiAoIXF1ZXJ5KSB7XG4gICAgICAgIG5ldyBOb3RpY2UoXCJQbGVhc2UgZW50ZXIgc2VhcmNoIHRleHRcIik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgc2VhcmNoQnRuLmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgIHNlYXJjaEJ0bi5pbm5lckhUTUwgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCI+PHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNMTIsNFYyQTEwLDEwIDAgMCwwIDIsMTJINEE4LDggMCAwLDEgMTIsNFpcIj48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPVwidHJhbnNmb3JtXCIgYXR0cmlidXRlVHlwZT1cIlhNTFwiIHR5cGU9XCJyb3RhdGVcIiBkdXI9XCIxc1wiIGZyb209XCIwIDEyIDEyXCIgdG89XCIzNjAgMTIgMTJcIiByZXBlYXRDb3VudD1cImluZGVmaW5pdGVcIiAvPjwvcGF0aD48L3N2Zz4gU2VhcmNoaW5nLi4uJztcbiAgICAgIFxuICAgICAgdGhpcy5zZWFyY2hSZXN1bHRzID0gYXdhaXQgdGhpcy5zZWFyY2hWYXVsdChxdWVyeSk7XG4gICAgICB0aGlzLnNlbGVjdGVkLmNsZWFyKCk7XG4gICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgXG4gICAgICBzZWFyY2hCdG4uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgIHNlYXJjaEJ0bi5pbm5lckhUTUwgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCI+PHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNMTUuNSwxMkMxOCwxMiAyMCwxNCAyMCwxNi41QzIwLDE3LjM4IDE5Ljc1LDE4LjIxIDE5LjMxLDE4LjlMMjIuMzksMjJMMjEsMjMuMzlMMTcuODgsMjAuMzJDMTcuMTksMjAuNzUgMTYuMzcsMjEgMTUuNSwyMUMxMywyMSAxMSwxOSAxMSwxNi41QzExLDE0IDEzLDEyIDE1LjUsMTJNMTUuNSwxNEEyLjUsMi41IDAgMCwwIDEzLDE2LjVBMi41LDIuNSAwIDAsMCAxNS41LDE5QTIuNSwyLjUgMCAwLDAgMTgsMTYuNUEyLjUsMi41IDAgMCwwIDE1LjUsMTRaXCI+PC9wYXRoPjwvc3ZnPiBTZWFyY2gnO1xuICAgIH07XG5cbiAgICAvLyBIYW5kbGUgRW50ZXIga2V5IGluIHNlYXJjaCBpbnB1dFxuICAgIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XG4gICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICBzZWFyY2hCdG4uY2xpY2soKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGUuY3JlYXRlRWwoXCJoclwiKTtcbiAgICBcbiAgICAvLyBSZXN1bHRzIGxpc3Qgd2l0aCBiZXR0ZXIgc3R5bGluZ1xuICAgIGNvbnN0IGxpc3RDb250YWluZXIgPSBlLmNyZWF0ZUVsKFwiZGl2XCIse2NsczpcInBpaS1saXN0XCJ9KTtcbiAgICBcbiAgICAvLyBEcm9wIGFyZWEgd2l0aCBpY29uIGFuZCBiZXR0ZXIgaW5zdHJ1Y3Rpb25zXG4gICAgY29uc3QgZHJvcEFyZWEgPSBlLmNyZWF0ZUVsKFwiZGl2XCIse2NsczpcInBpaS1kcm9wXCJ9KTtcbiAgICBkcm9wQXJlYS5jcmVhdGVFbChcImRpdlwiLCB7Y2xzOiBcInBpaS1kcm9wLWljb25cIiwgdGV4dDogXCJcIn0pO1xuICAgIGRyb3BBcmVhLmNyZWF0ZUVsKFwiZGl2XCIsIHt0ZXh0OiBcIkRyYWcgaXRlbXMgaGVyZSB0byBlbmNyeXB0XCJ9KTtcblxuICAgIC8qIEZvb3RlcjogTG9jayAvIFVubG9jayBidXR0b25zICovXG4gICAgY29uc3QgYm90PWUuY3JlYXRlRWwoXCJkaXZcIix7Y2xzOlwicGlpLWJ0bi1iYXItYm90dG9tXCJ9KTtcbiAgICBcbiAgICAvLyBMb2NrIGJ1dHRvbiB3aXRoIGljb25cbiAgICBjb25zdCBsb2NrQnRuID0gYm90LmNyZWF0ZUVsKFwiYnV0dG9uXCIse2NsczpcInBpaS1idG4tcHJpbWFyeSBwaWktYnRuLWhhbGZcIn0pO1xuICAgIGxvY2tCdG4uaW5uZXJIVE1MID0gJzxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiPjxwYXRoIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBkPVwiTTEyLDE3QTIsMiAwIDAsMCAxNCwxNUMxNCwxMy44OSAxMy4xLDEzIDEyLDEzQTIsMiAwIDAsMCAxMCwxNUEyLDIgMCAwLDAgMTIsMTdNMTgsOEEyLDIgMCAwLDEgMjAsMTBWMjBBMiwyIDAgMCwxIDE4LDIySDZBMiwyIDAgMCwxIDQsMjBWMTBDNCw4Ljg5IDQuOSw4IDYsOEg3VjZBNSw1IDAgMCwxIDEyLDFBNSw1IDAgMCwxIDE3LDZWOEgxOE0xMiwzQTMsMyAwIDAsMCA5LDZWOEgxNVY2QTMsMyAwIDAsMCAxMiwzWlwiPjwvcGF0aD48L3N2Zz4gTG9jayBTZWxlY3RlZCc7XG4gICAgbG9ja0J0bi5vbmNsaWNrPSgpPT50aGlzLmxvY2soKTtcbiAgICBcbiAgICAvLyBVbmxvY2sgYnV0dG9uIHdpdGggaWNvblxuICAgIGNvbnN0IHVubG9ja0J0biA9IGJvdC5jcmVhdGVFbChcImJ1dHRvblwiLHtjbHM6XCJwaWktYnRuLXNlY29uZGFyeSBwaWktYnRuLWhhbGZcIn0pO1xuICAgIHVubG9ja0J0bi5pbm5lckhUTUwgPSAnPHN2ZyB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCI+PHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNMTgsOEEyLDIgMCAwLDEgMjAsMTBWMjBBMiwyIDAgMCwxIDE4LDIySDZDNC44OSwyMiA0LDIxLjEgNCwyMFYxMEEyLDIgMCAwLDEgNiw4SDE1VjZBMywzIDAgMCwwIDEyLDNBMywzIDAgMCwwIDksNkg3QTUsNSAwIDAsMSAxMiwxQTUsNSAwIDAsMSAxNyw2VjhIMThNMTIsMTdBMiwyIDAgMCwwIDE0LDE1QTIsMiAwIDAsMCAxMiwxM0EyLDIgMCAwLDAgMTAsMTVBMiwyIDAgMCwwIDEyLDE3WlwiPjwvcGF0aD48L3N2Zz4gVW5sb2NrIEFsbCc7XG4gICAgdW5sb2NrQnRuLm9uY2xpY2s9KCk9PnRoaXMudW5sb2NrKCk7XG4gIH1cbiAgYXN5bmMgb25DbG9zZSgpe1xuICAgIHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICB0aGlzLmNsZWFudXBUZXh0U2VsZWN0aW9uRHJhZ0Ryb3AoKTtcbiAgfVxuXG4gIC8qIC0tLS0tLS0tIFRleHQgU2VsZWN0aW9uIERyYWcgJiBEcm9wIFNldHVwIC0tLS0tLS0tICovXG4gIHByaXZhdGUgc2V0dXBUZXh0U2VsZWN0aW9uRHJhZ0Ryb3AoKSB7XG4gICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycyB0byBkZXRlY3QgdGV4dCBzZWxlY3Rpb24gYW5kIGVuYWJsZSBkcmFnZ2luZ1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLmhhbmRsZVRleHRTZWxlY3Rpb24uYmluZCh0aGlzKSk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgdGhpcy5oYW5kbGVEcmFnU3RhcnQuYmluZCh0aGlzKSk7XG4gIH1cblxuICBwcml2YXRlIGNsZWFudXBUZXh0U2VsZWN0aW9uRHJhZ0Ryb3AoKSB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuaGFuZGxlVGV4dFNlbGVjdGlvbi5iaW5kKHRoaXMpKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdkcmFnc3RhcnQnLCB0aGlzLmhhbmRsZURyYWdTdGFydC5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlVGV4dFNlbGVjdGlvbihldmVudDogTW91c2VFdmVudCkge1xuICAgIGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcbiAgICBpZiAoIXNlbGVjdGlvbiB8fCBzZWxlY3Rpb24ucmFuZ2VDb3VudCA9PT0gMCkgcmV0dXJuO1xuICAgIFxuICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IHNlbGVjdGlvbi50b1N0cmluZygpLnRyaW0oKTtcbiAgICBpZiAoIXNlbGVjdGVkVGV4dCkgcmV0dXJuO1xuICAgIFxuICAgIC8vIENoZWNrIGlmIHRoZSBzZWxlY3Rpb24gaXMgd2l0aGluIGFuIGVkaXRvclxuICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICBjb25zdCBlZGl0b3JDb250YWluZXIgPSB0YXJnZXQuY2xvc2VzdCgnLm1hcmtkb3duLXNvdXJjZS12aWV3LCAuY20tZWRpdG9yJyk7XG4gICAgaWYgKCFlZGl0b3JDb250YWluZXIpIHJldHVybjtcbiAgICBcbiAgICAvLyBNYWtlIHRoZSBzZWxlY3RlZCB0ZXh0IGRyYWdnYWJsZSBieSBjcmVhdGluZyBhIHRlbXBvcmFyeSBkcmFnZ2FibGUgZWxlbWVudFxuICAgIGNvbnN0IHJhbmdlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XG4gICAgaWYgKHJhbmdlLmNvbGxhcHNlZCkgcmV0dXJuO1xuICAgIFxuICAgIC8vIENyZWF0ZSBhIHRlbXBvcmFyeSBkcmFnZ2FibGUgd3JhcHBlciBhcm91bmQgdGhlIHNlbGVjdGlvblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgc3Bhbi5kcmFnZ2FibGUgPSB0cnVlO1xuICAgICAgc3Bhbi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAndmFyKC0tdGV4dC1zZWxlY3Rpb24pJztcbiAgICAgIHNwYW4uc3R5bGUuY3Vyc29yID0gJ2dyYWInO1xuICAgICAgc3Bhbi50aXRsZSA9ICdEcmFnIHRvIGVuY3J5cHQgdGhpcyB0ZXh0JztcbiAgICAgIFxuICAgICAgLy8gU3RvcmUgdGhlIHNlbGVjdGVkIHRleHQgZGF0YSBmb3IgZHJhZyBhbmQgZHJvcFxuICAgICAgc3Bhbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2VsZWN0ZWQtdGV4dCcsIHNlbGVjdGVkVGV4dCk7XG4gICAgICBcbiAgICAgIHJhbmdlLnN1cnJvdW5kQ29udGVudHMoc3Bhbik7XG4gICAgICBcbiAgICAgIC8vIFJlbW92ZSB0aGUgZHJhZ2dhYmxlIHdyYXBwZXIgYWZ0ZXIgYSBzaG9ydCBkZWxheSBpZiBub3QgZHJhZ2dlZFxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlmIChzcGFuICYmIHNwYW4ucGFyZW50Tm9kZSkge1xuICAgICAgICAgIGNvbnN0IHBhcmVudCA9IHNwYW4ucGFyZW50Tm9kZTtcbiAgICAgICAgICB3aGlsZSAoc3Bhbi5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKHNwYW4uZmlyc3RDaGlsZCwgc3Bhbik7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChzcGFuKTtcbiAgICAgICAgfVxuICAgICAgfSwgNTAwMCk7XG4gICAgICBcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmxvZygnQ291bGQgbm90IG1ha2Ugc2VsZWN0aW9uIGRyYWdnYWJsZTonLCBlKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZURyYWdTdGFydChldmVudDogRHJhZ0V2ZW50KSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgIGNvbnN0IHNlbGVjdGVkVGV4dCA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2VsZWN0ZWQtdGV4dCcpO1xuICAgIFxuICAgIGlmIChzZWxlY3RlZFRleHQgJiYgZXZlbnQuZGF0YVRyYW5zZmVyKSB7XG4gICAgICBldmVudC5kYXRhVHJhbnNmZXIuc2V0RGF0YSgndGV4dC9wbGFpbicsIHNlbGVjdGVkVGV4dCk7XG4gICAgICBldmVudC5kYXRhVHJhbnNmZXIuc2V0RGF0YSgnYXBwbGljYXRpb24veC1zZWxlY3RlZC10ZXh0Jywgc2VsZWN0ZWRUZXh0KTtcbiAgICAgIGV2ZW50LmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gJ2NvcHknO1xuICAgIH1cbiAgfVxuXG4gIC8qIC0tLS0tLS0tIFNlYXJjaCBWYXVsdCAtLS0tLS0tLSAqL1xuICBwcml2YXRlIGFzeW5jIHNlYXJjaFZhdWx0KHF1ZXJ5OiBzdHJpbmcpOiBQcm9taXNlPE1hdGNoSW5mb1tdPiB7XG4gICAgY29uc3QgcmVzdWx0czogTWF0Y2hJbmZvW10gPSBbXTtcbiAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpO1xuICAgICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICAgIFxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbaV07XG4gICAgICAgIGxldCBpbmRleCA9IDA7XG4gICAgICAgIFxuICAgICAgICAvLyBGaW5kIGFsbCBvY2N1cnJlbmNlcyBvZiB0aGUgcXVlcnkgaW4gdGhpcyBsaW5lXG4gICAgICAgIHdoaWxlICgoaW5kZXggPSBsaW5lLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihxdWVyeS50b0xvd2VyQ2FzZSgpLCBpbmRleCkpICE9PSAtMSkge1xuICAgICAgICAgIGNvbnN0IG1hdGNoOiBNYXRjaEluZm8gPSB7XG4gICAgICAgICAgICB0ZXh0OiBsaW5lLnN1YnN0cmluZyhpbmRleCwgaW5kZXggKyBxdWVyeS5sZW5ndGgpLFxuICAgICAgICAgICAgZmlsZTogZmlsZSxcbiAgICAgICAgICAgIGxpbmU6IGksXG4gICAgICAgICAgICBjb2w6IGluZGV4XG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXN1bHRzLnB1c2gobWF0Y2gpO1xuICAgICAgICAgIGluZGV4ICs9IHF1ZXJ5Lmxlbmd0aDsgLy8gTW92ZSBwYXN0IHRoaXMgbWF0Y2ggdG8gZmluZCBuZXh0IG9jY3VycmVuY2VcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfVxuXG4gIC8qIC0tLS0tLS0tIFJlbmRlciBVSSAtLS0tLS0tLSAqL1xuICBwcml2YXRlIHJlbmRlcigpe1xuICAgIGNvbnN0IGxpc3QgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIucGlpLWxpc3RcIikgYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29uc3QgZHJvcCA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcihcIi5waWktZHJvcFwiKSBhcyBIVE1MRWxlbWVudDtcbiAgICBjb25zdCBzZWFyY2hDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIucGlpLXNlYXJjaC1jb250YWluZXJcIikgYXMgSFRNTEVsZW1lbnQ7XG4gICAgY29uc3Qgc2NhbkNvbnRyb2xzID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKFwiLnBpaS1zY2FuLWNvbnRyb2xzXCIpIGFzIEhUTUxFbGVtZW50O1xuICAgIGNvbnN0IG1vZGVDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoXCIucGlpLW1vZGUtdG9nZ2xlXCIpIGFzIEhUTUxFbGVtZW50O1xuICAgIFxuICAgIC8vIFNob3cvaGlkZSBjb250cm9scyBiYXNlZCBvbiBtb2RlXG4gICAgaWYgKHNlYXJjaENvbnRhaW5lcikge1xuICAgICAgc2VhcmNoQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSB0aGlzLmN1cnJlbnRNb2RlID09PSAnc2VhcmNoJyA/ICdmbGV4JyA6ICdub25lJztcbiAgICB9XG4gICAgaWYgKHNjYW5Db250cm9scykge1xuICAgICAgc2NhbkNvbnRyb2xzLnN0eWxlLmRpc3BsYXkgPSB0aGlzLmN1cnJlbnRNb2RlID09PSAnc2NhbicgPyAnZmxleCcgOiAnbm9uZSc7XG4gICAgfVxuICAgIFxuICAgIC8vIENsZWFyIHByZXZpb3VzIGNvbnRlbnRcbiAgICBsaXN0LmVtcHR5KCk7XG4gICAgXG4gICAgLy8gUmVzZXQgZHJvcCBhcmVhXG4gICAgZHJvcC5lbXB0eSgpO1xuICAgIGRyb3AuY3JlYXRlRWwoXCJkaXZcIiwge2NsczogXCJwaWktZHJvcC1pY29uXCIsIHRleHQ6IFwiXHVEODNEXHVERDEyXCJ9KTtcbiAgICBkcm9wLmNyZWF0ZUVsKFwiZGl2XCIsIHt0ZXh0OiBcIkRyYWcgaXRlbXMgaGVyZSB0byBlbmNyeXB0XCJ9KTtcblxuICAgIC8vIEdldCBjdXJyZW50IHJlc3VsdHMgYmFzZWQgb24gbW9kZVxuICAgIGNvbnN0IGN1cnJlbnRSZXN1bHRzID0gdGhpcy5jdXJyZW50TW9kZSA9PT0gJ3NjYW4nID8gdGhpcy5tYXRjaGVzIDogdGhpcy5zZWFyY2hSZXN1bHRzO1xuICAgIGNvbnN0IGVtcHR5TWVzc2FnZSA9IHRoaXMuY3VycmVudE1vZGUgPT09ICdzY2FuJyA/IFwiTm8gc2Vuc2l0aXZlIGluZm9ybWF0aW9uIGZvdW5kXCIgOiBcIk5vIHNlYXJjaCByZXN1bHRzIGZvdW5kXCI7XG5cbiAgICAvLyBTaG93IGVtcHR5IHN0YXRlIGlmIG5vIHJlc3VsdHNcbiAgICBpZighY3VycmVudFJlc3VsdHMubGVuZ3RoKXtcbiAgICAgIGxpc3QuY3JlYXRlRWwoXCJkaXZcIiwge2NsczogXCJwaWktZW1wdHlcIn0pO1xuICAgICAgbGlzdC5jcmVhdGVFbChcImRpdlwiLCB7Y2xzOiBcInBpaS1lbXB0eVwifSkuaW5uZXJIVE1MID0gJzxzdmcgdmlld0JveD1cIjAgMCAyNCAyNFwiIHdpZHRoPVwiMzJcIiBoZWlnaHQ9XCIzMlwiIHN0eWxlPVwib3BhY2l0eTogMC41XCI+PHBhdGggZmlsbD1cImN1cnJlbnRDb2xvclwiIGQ9XCJNMTIsMkExMCwxMCAwIDAsMCAyLDEyQTEwLDEwIDAgMCwwIDEyLDIyQTEwLDEwIDAgMCwwIDIyLDEyQTEwLDEwIDAgMCwwIDEyLDJNMTIsNEE4LDggMCAwLDEgMjAsMTJBOCw4IDAgMCwxIDEyLDIwQTgsOCAwIDAsMSA0LDEyQTgsOCAwIDAsMSAxMiw0TTEyLDEwLjVBMS41LDEuNSAwIDAsMCAxMC41LDEyQTEuNSwxLjUgMCAwLDAgMTIsMTMuNUExLjUsMS41IDAgMCwwIDEzLjUsMTJBMS41LDEuNSAwIDAsMCAxMiwxMC41TTcuNSwxMC41QTEuNSwxLjUgMCAwLDAgNiwxMkExLjUsMS41IDAgMCwwIDcuNSwxMy41QTEuNSwxLjUgMCAwLDAgOSwxMkExLjUsMS41IDAgMCwwIDcuNSwxMC41TTE2LjUsMTAuNUExLjUsMS41IDAgMCwwIDE1LDEyQTEuNSwxLjUgMCAwLDAgMTYuNSwxMy41QTEuNSwxLjUgMCAwLDAgMTgsMTJBMS41LDEuNSAwIDAsMCAxNi41LDEwLjVaXCI+PC9wYXRoPjwvc3ZnPic7XG4gICAgICBsaXN0LmNyZWF0ZUVsKFwicFwiLCB7dGV4dDogZW1wdHlNZXNzYWdlfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIHJvd3MgZm9yIGVhY2ggcmVzdWx0XG4gICAgY3VycmVudFJlc3VsdHMuZm9yRWFjaCgobSxpKT0+e1xuICAgICAgY29uc3Qgcm93ID0gbGlzdC5jcmVhdGVFbChcImRpdlwiLCB7Y2xzOiBcInBpaS1yb3dcIn0pO1xuICAgICAgXG4gICAgICAvLyBBZGQgdGV4dCBjb250ZW50IHdpdGggZWxsaXBzaXMgZm9yIGxvbmcgdGV4dFxuICAgICAgY29uc3QgdGV4dEVsID0gcm93LmNyZWF0ZUVsKFwiZGl2XCIsIHtjbHM6IFwicGlpLXJvdy10ZXh0XCIsIHRleHQ6IG0udGV4dH0pO1xuICAgICAgXG4gICAgICAvLyBBZGQgZmlsZSBsb2NhdGlvbiBpbmZvXG4gICAgICByb3cuY3JlYXRlRWwoXCJkaXZcIiwge2NsczogXCJwaWktcm93LWxvY2F0aW9uXCIsIHRleHQ6IGAke20uZmlsZS5iYXNlbmFtZX06JHttLmxpbmUrMX1gfSk7XG4gICAgICBcbiAgICAgIC8vIE1ha2Ugcm93IGRyYWdnYWJsZVxuICAgICAgcm93LnNldEF0dHIoXCJkcmFnZ2FibGVcIiwgXCJ0cnVlXCIpO1xuICAgICAgcm93Lm9uZHJhZ3N0YXJ0ID0gZSA9PiBlLmRhdGFUcmFuc2Zlcj8uc2V0RGF0YShcInRleHQvcGxhaW5cIiwgU3RyaW5nKGkpKTtcbiAgICAgIFxuICAgICAgLy8gTWFrZSByb3cgY2xpY2thYmxlIHRvIG5hdmlnYXRlIHRvIHRoZSBmaWxlIGxvY2F0aW9uXG4gICAgICByb3cub25jbGljayA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcbiAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShtLmZpbGUpO1xuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpXG4gICAgICAgICAgPy5lZGl0b3Iuc2V0Q3Vyc29yKHtsaW5lOiBtLmxpbmUsIGNoOiBtLmNvbH0pO1xuICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8vIFNldCB1cCBkcm9wIGFyZWEgaW50ZXJhY3Rpb25zXG4gICAgZHJvcC5vbmRyYWdvdmVyID0gZSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7IFxuICAgICAgZHJvcC5hZGRDbGFzcyhcImhvdmVyXCIpO1xuICAgIH07XG4gICAgXG4gICAgZHJvcC5vbmRyYWdsZWF2ZSA9ICgpID0+IGRyb3AucmVtb3ZlQ2xhc3MoXCJob3ZlclwiKTtcbiAgICBcbiAgICBkcm9wLm9uZHJvcCA9IGUgPT4ge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyBcbiAgICAgIGRyb3AucmVtb3ZlQ2xhc3MoXCJob3ZlclwiKTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIG1hbnVhbGx5IHNlbGVjdGVkIHRleHQgZHJvcFxuICAgICAgY29uc3Qgc2VsZWN0ZWRUZXh0ID0gZS5kYXRhVHJhbnNmZXI/LmdldERhdGEoXCJhcHBsaWNhdGlvbi94LXNlbGVjdGVkLXRleHRcIik7XG4gICAgICBpZiAoc2VsZWN0ZWRUZXh0KSB7XG4gICAgICAgIHRoaXMuYWRkTWFudWFsU2VsZWN0aW9uKHNlbGVjdGVkVGV4dCwgZHJvcCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSGFuZGxlIGV4aXN0aW5nIGRyYWcgYW5kIGRyb3AgZnJvbSByZXN1bHRzIGxpc3RcbiAgICAgIGNvbnN0IGkgPSBwYXJzZUludChlLmRhdGFUcmFuc2Zlcj8uZ2V0RGF0YShcInRleHQvcGxhaW5cIikgfHwgXCItMVwiKTtcbiAgICAgIGlmIChpID49IDAgJiYgIXRoaXMuc2VsZWN0ZWQuaGFzKGkpKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQuYWRkKGkpO1xuICAgICAgICBjb25zdCB0YWcgPSBkcm9wLmNyZWF0ZUVsKFwiZGl2XCIsIHtjbHM6IFwicGlpLXRhZ1wifSk7XG4gICAgICAgIHRhZy50ZXh0Q29udGVudCA9IGN1cnJlbnRSZXN1bHRzW2ldLnRleHQ7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgYSByZW1vdmUgYnV0dG9uIHRvIHRoZSB0YWdcbiAgICAgICAgY29uc3QgcmVtb3ZlQnRuID0gdGFnLmNyZWF0ZUVsKFwic3BhblwiLCB7Y2xzOiBcInBpaS10YWctcmVtb3ZlXCIsIHRleHQ6IFwiXHUwMEQ3XCJ9KTtcbiAgICAgICAgcmVtb3ZlQnRuLnN0eWxlLm1hcmdpbkxlZnQgPSBcIjRweFwiO1xuICAgICAgICByZW1vdmVCdG4uc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG4gICAgICAgIHJlbW92ZUJ0bi5zdHlsZS5mb250V2VpZ2h0ID0gXCJib2xkXCI7XG4gICAgICAgIFxuICAgICAgICByZW1vdmVCdG4ub25jbGljayA9IChldnQpID0+IHtcbiAgICAgICAgICBldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgdGhpcy5zZWxlY3RlZC5kZWxldGUoaSk7XG4gICAgICAgICAgdGFnLnJlbW92ZSgpO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvKiAtLS0tLS0tLSBBZGQgTWFudWFsIFNlbGVjdGlvbiAtLS0tLS0tLSAqL1xuICBwcml2YXRlIGFkZE1hbnVhbFNlbGVjdGlvbih0ZXh0OiBzdHJpbmcsIGRyb3BBcmVhOiBIVE1MRWxlbWVudCkge1xuICAgIC8vIEdlbmVyYXRlIGEgdW5pcXVlIElEIGZvciB0aGlzIHNlbGVjdGlvblxuICAgIGNvbnN0IGlkID0gbWFrZVVVSUQoKTtcbiAgICBcbiAgICAvLyBBZGQgdG8gbWFudWFsIHNlbGVjdGlvbnNcbiAgICB0aGlzLm1hbnVhbFNlbGVjdGlvbnMucHVzaCh7dGV4dCwgaWR9KTtcbiAgICBcbiAgICAvLyBDcmVhdGUgYSB0YWcgaW4gdGhlIGRyb3AgYXJlYVxuICAgIGNvbnN0IHRhZyA9IGRyb3BBcmVhLmNyZWF0ZUVsKFwiZGl2XCIsIHtjbHM6IFwicGlpLXRhZyBwaWktdGFnLW1hbnVhbFwifSk7XG4gICAgdGFnLnRleHRDb250ZW50ID0gdGV4dDtcbiAgICB0YWcuc2V0QXR0cmlidXRlKCdkYXRhLW1hbnVhbC1pZCcsIGlkKTtcbiAgICBcbiAgICAvLyBBZGQgYSByZW1vdmUgYnV0dG9uIHRvIHRoZSB0YWdcbiAgICBjb25zdCByZW1vdmVCdG4gPSB0YWcuY3JlYXRlRWwoXCJzcGFuXCIsIHtjbHM6IFwicGlpLXRhZy1yZW1vdmVcIiwgdGV4dDogXCJcdTAwRDdcIn0pO1xuICAgIHJlbW92ZUJ0bi5zdHlsZS5tYXJnaW5MZWZ0ID0gXCI0cHhcIjtcbiAgICByZW1vdmVCdG4uc3R5bGUuY3Vyc29yID0gXCJwb2ludGVyXCI7XG4gICAgcmVtb3ZlQnRuLnN0eWxlLmZvbnRXZWlnaHQgPSBcImJvbGRcIjtcbiAgICBcbiAgICByZW1vdmVCdG4ub25jbGljayA9IChldnQpID0+IHtcbiAgICAgIGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIC8vIFJlbW92ZSBmcm9tIG1hbnVhbCBzZWxlY3Rpb25zXG4gICAgICB0aGlzLm1hbnVhbFNlbGVjdGlvbnMgPSB0aGlzLm1hbnVhbFNlbGVjdGlvbnMuZmlsdGVyKHMgPT4gcy5pZCAhPT0gaWQpO1xuICAgICAgdGFnLnJlbW92ZSgpO1xuICAgIH07XG4gICAgXG4gICAgbmV3IE5vdGljZShgQWRkZWQgXCIke3RleHQuc3Vic3RyaW5nKDAsIDMwKX0ke3RleHQubGVuZ3RoID4gMzAgPyAnLi4uJyA6ICcnfVwiIGZvciBlbmNyeXB0aW9uYCk7XG4gIH1cblxuICAvKiAtLS0tLS0tLSBFbmNyeXB0IE1hbnVhbCBTZWxlY3Rpb24gLS0tLS0tLS0gKi9cbiAgcHJpdmF0ZSBhc3luYyBlbmNyeXB0TWFudWFsU2VsZWN0aW9uKHRleHQ6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vIEdldCB0aGUgY3VycmVudGx5IGFjdGl2ZSBmaWxlXG4gICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgaWYgKCFhY3RpdmVGaWxlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhY3RpdmUgZmlsZSB0byBlbmNyeXB0IHRleHQgaW5cIik7XG4gICAgfVxuICAgIFxuICAgIC8vIFJlYWQgdGhlIGZpbGUgY29udGVudFxuICAgIGxldCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQoYWN0aXZlRmlsZSk7XG4gICAgXG4gICAgLy8gRmluZCB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiB0aGUgdGV4dFxuICAgIGNvbnN0IGluZGV4ID0gZmlsZUNvbnRlbnQuaW5kZXhPZih0ZXh0KTtcbiAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICBjb25zb2xlLndhcm4oYFRleHQgbm90IGZvdW5kIGluIGFjdGl2ZSBmaWxlOiAke3RleHQuc3Vic3RyaW5nKDAsIDUwKX1gKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgLy8gRW5jcnlwdCB0aGUgdGV4dFxuICAgIGNvbnN0IGNpcGhlciA9IGF3YWl0IGVuY3J5cHQodGV4dCwgcGFzc3dvcmQpO1xuICAgIGNvbnN0IHdyYXBwZWQgPSBgPGRldGFpbHM+XFxuIDxzdW1tYXJ5PkxvY2s8L3N1bW1hcnk+XFxuIFx1MDBBN0VOQ18ke21ha2VVVUlEKCkuc2xpY2UoMCw2KX1fJHtjaXBoZXJ9XHUwMEE3XFxuPC9kZXRhaWxzPmA7XG4gICAgXG4gICAgLy8gUmVwbGFjZSB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiB0aGUgdGV4dCB3aXRoIGVuY3J5cHRlZCB2ZXJzaW9uXG4gICAgZmlsZUNvbnRlbnQgPSBmaWxlQ29udGVudC5zdWJzdHJpbmcoMCwgaW5kZXgpICsgd3JhcHBlZCArIGZpbGVDb250ZW50LnN1YnN0cmluZyhpbmRleCArIHRleHQubGVuZ3RoKTtcbiAgICBcbiAgICAvLyBTYXZlIHRoZSBtb2RpZmllZCBmaWxlXG4gICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGFjdGl2ZUZpbGUsIGZpbGVDb250ZW50KTtcbiAgfVxuXG4gIC8qIC0tLS0tLS0tIEdldCBQYXNzd29yZCAod2l0aCBjYWNoaW5nKSAtLS0tLS0tLSAqL1xuICBwcml2YXRlIGFzeW5jIGdldFBhc3N3b3JkKGlzRW5jcnlwdDogYm9vbGVhbiA9IGZhbHNlKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gICAgLy8gSWYgd2UgaGF2ZSBhIGNhY2hlZCBwYXNzd29yZCwgdXNlIGl0XG4gICAgaWYgKHRoaXMuY2FjaGVkUGFzc3dvcmQpIHtcbiAgICAgIHJldHVybiB0aGlzLmNhY2hlZFBhc3N3b3JkO1xuICAgIH1cbiAgICBcbiAgICAvLyBJZiB3ZSBoYXZlIGEgc3RvcmVkIHBhc3N3b3JkIGFuZCB0aGlzIGlzIGRlY3J5cHRpb24sIHRyeSB0byB1c2UgdGhlIHN0b3JlZCBvbmVcbiAgICBpZiAoIWlzRW5jcnlwdCAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdG9yZWRQYXNzd29yZCkge1xuICAgICAgLy8gRm9yIG5vdywgd2Ugc3RpbGwgbmVlZCB0byBwcm9tcHQgZm9yIHRoZSBhY3R1YWwgcGFzc3dvcmQgc2luY2Ugd2Ugb25seSBzdG9yZSBoYXNoXG4gICAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHlvdSdkIHVzZSBwcm9wZXIga2V5IGRlcml2YXRpb25cbiAgICAgIGNvbnN0IHB3ZCA9IGF3YWl0IG5ldyBQd01vZGFsKHRoaXMuYXBwLCBcIkVudGVyIFlvdXIgUGFzc3dvcmRcIiwgZmFsc2UpLndhaXQoKTtcbiAgICAgIGlmIChwd2QpIHtcbiAgICAgICAgLy8gVmVyaWZ5IGFnYWluc3Qgc3RvcmVkIGhhc2hcbiAgICAgICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICAgICAgICBjb25zdCBkYXRhID0gZW5jb2Rlci5lbmNvZGUocHdkKTtcbiAgICAgICAgY29uc3QgaGFzaEJ1ZmZlciA9IGF3YWl0IGNyeXB0by5zdWJ0bGUuZGlnZXN0KCdTSEEtMjU2JywgZGF0YSk7XG4gICAgICAgIGNvbnN0IGhhc2hBcnJheSA9IEFycmF5LmZyb20obmV3IFVpbnQ4QXJyYXkoaGFzaEJ1ZmZlcikpO1xuICAgICAgICBjb25zdCBoYXNoSGV4ID0gaGFzaEFycmF5Lm1hcChiID0+IGIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykpLmpvaW4oJycpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGhhc2hIZXggPT09IHRoaXMucGx1Z2luLnNldHRpbmdzLnN0b3JlZFBhc3N3b3JkKSB7XG4gICAgICAgICAgdGhpcy5jYWNoZWRQYXNzd29yZCA9IHB3ZDtcbiAgICAgICAgICByZXR1cm4gcHdkO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ldyBOb3RpY2UoXCJJbmNvcnJlY3QgcGFzc3dvcmRcIik7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBcbiAgICAvLyBTaG93IHBhc3N3b3JkIG1vZGFsXG4gICAgY29uc3QgdGl0bGUgPSBpc0VuY3J5cHQgPyBcIkVuY3J5cHQgU2Vuc2l0aXZlIEluZm9ybWF0aW9uXCIgOiBcIkRlY3J5cHQgUHJvdGVjdGVkIEluZm9ybWF0aW9uXCI7XG4gICAgY29uc3QgcHdkID0gYXdhaXQgbmV3IFB3TW9kYWwodGhpcy5hcHAsIHRpdGxlLCBpc0VuY3J5cHQpLndhaXQoKTtcbiAgICBcbiAgICBpZiAocHdkKSB7XG4gICAgICB0aGlzLmNhY2hlZFBhc3N3b3JkID0gcHdkO1xuICAgICAgXG4gICAgICAvLyBJZiB0aGlzIGlzIGVuY3J5cHRpb24gYW5kIG5vIHBhc3N3b3JkIGlzIHN0b3JlZCwgb2ZmZXIgdG8gc2F2ZSBpdFxuICAgICAgaWYgKGlzRW5jcnlwdCAmJiAhdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3RvcmVkUGFzc3dvcmQpIHtcbiAgICAgICAgLy8gQXV0by1zYXZlIHRoZSBwYXNzd29yZCBoYXNoIGZvciBmdXR1cmUgdXNlXG4gICAgICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgICAgICAgY29uc3QgZGF0YSA9IGVuY29kZXIuZW5jb2RlKHB3ZCk7XG4gICAgICAgIGNvbnN0IGhhc2hCdWZmZXIgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmRpZ2VzdCgnU0hBLTI1NicsIGRhdGEpO1xuICAgICAgICBjb25zdCBoYXNoQXJyYXkgPSBBcnJheS5mcm9tKG5ldyBVaW50OEFycmF5KGhhc2hCdWZmZXIpKTtcbiAgICAgICAgY29uc3QgaGFzaEhleCA9IGhhc2hBcnJheS5tYXAoYiA9PiBiLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLCAnMCcpKS5qb2luKCcnKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnN0b3JlZFBhc3N3b3JkID0gaGFzaEhleDtcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIG5ldyBOb3RpY2UoXCJQYXNzd29yZCBzYXZlZCBmb3IgZnV0dXJlIHVzZVwiKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHB3ZDtcbiAgfVxuICBcbiAgLyogLS0tLS0tLS0gQ2xlYXIgY2FjaGVkIHBhc3N3b3JkIC0tLS0tLS0tICovXG4gIHByaXZhdGUgY2xlYXJDYWNoZWRQYXNzd29yZCgpIHtcbiAgICB0aGlzLmNhY2hlZFBhc3N3b3JkID0gbnVsbDtcbiAgfVxuXG4gIC8qIC0tLS0tLS0tIEVuY3J5cHQgKExvY2spIC0tLS0tLS0tICovXG4gIHByaXZhdGUgYXN5bmMgbG9jaygpe1xuICAgIC8vIEdldCBjdXJyZW50IHJlc3VsdHMgYmFzZWQgb24gbW9kZVxuICAgIGNvbnN0IGN1cnJlbnRSZXN1bHRzID0gdGhpcy5jdXJyZW50TW9kZSA9PT0gJ3NjYW4nID8gdGhpcy5tYXRjaGVzIDogdGhpcy5zZWFyY2hSZXN1bHRzO1xuICAgIFxuICAgIC8vIElmIG5vdGhpbmcgZXhwbGljaXRseSBzZWxlY3RlZCwgc2VsZWN0IGFsbCBjdXJyZW50IHJlc3VsdHNcbiAgICBpZighdGhpcy5zZWxlY3RlZC5zaXplKXtcbiAgICAgIGN1cnJlbnRSZXN1bHRzLmZvckVhY2goKF8saSk9PnRoaXMuc2VsZWN0ZWQuYWRkKGkpKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBhbnl0aGluZyB0byBlbmNyeXB0IChlaXRoZXIgc2VsZWN0aW9ucyBvciBtYW51YWwgc2VsZWN0aW9ucylcbiAgICBpZighdGhpcy5zZWxlY3RlZC5zaXplICYmICF0aGlzLm1hbnVhbFNlbGVjdGlvbnMubGVuZ3RoKSB7XG4gICAgICBuZXcgTm90aWNlKFwiTm8gaXRlbXMgc2VsZWN0ZWQgZm9yIGVuY3J5cHRpb25cIik7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIEdldCBwYXNzd29yZCAod2l0aCBjYWNoaW5nL3N0b3JhZ2UgbG9naWMpXG4gICAgY29uc3QgcHdkID0gYXdhaXQgdGhpcy5nZXRQYXNzd29yZCh0cnVlKTtcbiAgICBpZighcHdkKSByZXR1cm47XG5cbiAgICAvLyBDYWxjdWxhdGUgdG90YWwgaXRlbXMgdG8gZW5jcnlwdFxuICAgIGNvbnN0IHRvdGFsSXRlbXMgPSB0aGlzLnNlbGVjdGVkLnNpemUgKyB0aGlzLm1hbnVhbFNlbGVjdGlvbnMubGVuZ3RoO1xuICAgIFxuICAgIC8vIFNob3cgcHJvZ3Jlc3MgaW5kaWNhdG9yXG4gICAgY29uc3Qgc3RhdHVzQmFyID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVFbChcImRpdlwiLCB7XG4gICAgICBjbHM6IFwicGlpLXN0YXR1c1wiLFxuICAgICAgdGV4dDogYEVuY3J5cHRpbmcgJHt0b3RhbEl0ZW1zfSBpdGVtKHMpLi4uYFxuICAgIH0pO1xuICAgIFxuICAgIHRyeSB7XG4gICAgICBsZXQgcHJvY2Vzc2VkQ291bnQgPSAwO1xuICAgICAgXG4gICAgICAvLyBQcm9jZXNzIGVhY2ggc2VsZWN0ZWQgaXRlbSBmcm9tIHNjYW4vc2VhcmNoIHJlc3VsdHNcbiAgICAgIGZvcihjb25zdCBpIG9mIHRoaXMuc2VsZWN0ZWQpe1xuICAgICAgICBjb25zdCBtID0gY3VycmVudFJlc3VsdHNbaV07XG4gICAgICAgIGNvbnN0IGZpbGUgPSBtLmZpbGU7XG4gICAgICAgIGxldCB0ZXh0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKTtcblxuICAgICAgICAvLyBFbmNyeXB0IHRoZSB0ZXh0XG4gICAgICAgIGNvbnN0IGNpcGhlciA9IGF3YWl0IGVuY3J5cHQobS50ZXh0LCBwd2QpO1xuICAgICAgICBjb25zdCB3cmFwcGVkID0gYDxkZXRhaWxzPlxcbiA8c3VtbWFyeT5Mb2NrPC9zdW1tYXJ5PlxcbiBcdTAwQTdFTkNfJHttYWtlVVVJRCgpLnNsaWNlKDAsNil9XyR7Y2lwaGVyfVx1MDBBN1xcbjwvZGV0YWlscz5gO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVwbGFjZSB0aGUgb3JpZ2luYWwgdGV4dCB3aXRoIGVuY3J5cHRlZCB2ZXJzaW9uXG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UobS50ZXh0LCB3cmFwcGVkKTtcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIHRleHQpO1xuICAgICAgICBwcm9jZXNzZWRDb3VudCsrO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBQcm9jZXNzIG1hbnVhbCBzZWxlY3Rpb25zXG4gICAgICBmb3IgKGNvbnN0IHNlbGVjdGlvbiBvZiB0aGlzLm1hbnVhbFNlbGVjdGlvbnMpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5lbmNyeXB0TWFudWFsU2VsZWN0aW9uKHNlbGVjdGlvbi50ZXh0LCBwd2QpO1xuICAgICAgICBwcm9jZXNzZWRDb3VudCsrO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTaG93IHN1Y2Nlc3MgbWVzc2FnZVxuICAgICAgbmV3IE5vdGljZShgU3VjY2Vzc2Z1bGx5IGVuY3J5cHRlZCAke3Byb2Nlc3NlZENvdW50fSBpdGVtKHMpYCk7XG4gICAgICBcbiAgICAgIC8vIENsZWFyIHRoZSByZXN1bHRzIGFuZCBzZWxlY3Rpb25zXG4gICAgICBpZiAodGhpcy5jdXJyZW50TW9kZSA9PT0gJ3NjYW4nKSB7XG4gICAgICAgIHRoaXMubWF0Y2hlcyA9IFtdO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZWFyY2hSZXN1bHRzID0gW107XG4gICAgICB9XG4gICAgICB0aGlzLnNlbGVjdGVkLmNsZWFyKCk7XG4gICAgICB0aGlzLm1hbnVhbFNlbGVjdGlvbnMgPSBbXTtcbiAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFbmNyeXB0aW9uIGVycm9yOlwiLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKFwiRXJyb3IgZHVyaW5nIGVuY3J5cHRpb24uIFBsZWFzZSB0cnkgYWdhaW4uXCIpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBSZW1vdmUgdGhlIHN0YXR1cyBiYXJcbiAgICAgIGlmIChzdGF0dXNCYXIgJiYgc3RhdHVzQmFyLnBhcmVudE5vZGUpIHtcbiAgICAgICAgc3RhdHVzQmFyLnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qIC0tLS0tLS0tIERlY3J5cHQgKFVubG9jaykgLS0tLS0tLS0gKi9cbiAgcHJpdmF0ZSBhc3luYyB1bmxvY2soKXtcbiAgICAvLyBHZXQgcGFzc3dvcmQgKHdpdGggY2FjaGluZy9zdG9yYWdlIGxvZ2ljKVxuICAgIGNvbnN0IHB3ZCA9IGF3YWl0IHRoaXMuZ2V0UGFzc3dvcmQoZmFsc2UpO1xuICAgIGlmKCFwd2QpIHJldHVybjtcblxuICAgIC8vIFBhdHRlcm4gdG8gbWF0Y2ggZW5jcnlwdGVkIGNvbnRlbnQgd2l0aGluIGRldGFpbHMgZWxlbWVudHNcbiAgICBjb25zdCBlbmNSZWdleCA9IC88ZGV0YWlscz5cXHMqPHN1bW1hcnk+TG9jazxcXC9zdW1tYXJ5PlxccypcdTAwQTdFTkNfW0EtWmEtejAtOV17Nn1fKC4qPylcdTAwQTdcXHMqPFxcL2RldGFpbHM+L2c7XG5cbiAgICAvLyBTaG93IHByb2dyZXNzIGluZGljYXRvclxuICAgIGNvbnN0IHN0YXR1c0JhciA9IHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkaXZcIiwge1xuICAgICAgY2xzOiBcInBpaS1zdGF0dXNcIixcbiAgICAgIHRleHQ6IFwiU2VhcmNoaW5nIGZvciBlbmNyeXB0ZWQgY29udGVudC4uLlwiXG4gICAgfSk7XG5cbiAgICB0cnkge1xuICAgICAgbGV0IHVubG9ja2VkID0gMDtcbiAgICAgIGxldCBmaWxlc1Byb2Nlc3NlZCA9IDA7XG4gICAgICBjb25zdCB0b3RhbEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmxlbmd0aDtcbiAgICAgIFxuICAgICAgLy8gUHJvY2VzcyBlYWNoIG1hcmtkb3duIGZpbGVcbiAgICAgIGZvcihjb25zdCBmIG9mIHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKSl7XG4gICAgICAgIGZpbGVzUHJvY2Vzc2VkKys7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgcHJvZ3Jlc3MgaW5kaWNhdG9yXG4gICAgICAgIHN0YXR1c0Jhci50ZXh0Q29udGVudCA9IGBQcm9jZXNzaW5nIGZpbGVzLi4uICgke2ZpbGVzUHJvY2Vzc2VkfS8ke3RvdGFsRmlsZXN9KWA7XG4gICAgICAgIFxuICAgICAgICBsZXQgdHh0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChmKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbmQgYWxsIGVuY3J5cHRlZCBtYXRjaGVzXG4gICAgICAgIGNvbnN0IG1hdGNoZXM6IHtmdWxsOiBzdHJpbmcsIGNpcGhlcjogc3RyaW5nfVtdID0gW107XG4gICAgICAgIGxldCBtYXRjaDtcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IGVuY1JlZ2V4LmV4ZWModHh0KSkgIT09IG51bGwpIHtcbiAgICAgICAgICBtYXRjaGVzLnB1c2goe1xuICAgICAgICAgICAgZnVsbDogbWF0Y2hbMF0sXG4gICAgICAgICAgICBjaXBoZXI6IG1hdGNoWzFdXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIElmIG5vIG1hdGNoZXMsIHNraXAgdG8gbmV4dCBmaWxlXG4gICAgICAgIGlmIChtYXRjaGVzLmxlbmd0aCA9PT0gMCkgY29udGludWU7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgc3RhdHVzIHRvIHNob3cgZGVjcnlwdGlvbiBpbiBwcm9ncmVzc1xuICAgICAgICBzdGF0dXNCYXIudGV4dENvbnRlbnQgPSBgRGVjcnlwdGluZyBjb250ZW50IGluICR7Zi5iYXNlbmFtZX0uLi5gO1xuICAgICAgICBcbiAgICAgICAgLy8gRGVjcnlwdCBhbGwgbWF0Y2hlc1xuICAgICAgICBsZXQgY2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICBmb3IgKGNvbnN0IG0gb2YgbWF0Y2hlcykge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBBd2FpdCB0aGUgZGVjcnlwdGlvbiBwcm9taXNlXG4gICAgICAgICAgICBjb25zdCBwbGFpbiA9IGF3YWl0IGRlY3J5cHQobS5jaXBoZXIsIHB3ZCk7XG4gICAgICAgICAgICAvLyBSZXBsYWNlIHRoZSBlbnRpcmUgZGV0YWlscyBlbGVtZW50IHdpdGggdGhlIGRlY3J5cHRlZCB0ZXh0XG4gICAgICAgICAgICB0eHQgPSB0eHQucmVwbGFjZShtLmZ1bGwsIHBsYWluKTtcbiAgICAgICAgICAgIHVubG9ja2VkKys7XG4gICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAvLyBJZiBkZWNyeXB0aW9uIGZhaWxzLCBpdCBtaWdodCBiZSB3cm9uZyBwYXNzd29yZCAtIGNsZWFyIGNhY2hlXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRGVjcnlwdGlvbiBmYWlsZWQ6XCIsIGUpO1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FjaGVkUGFzc3dvcmQpIHtcbiAgICAgICAgICAgICAgdGhpcy5jbGVhckNhY2hlZFBhc3N3b3JkKCk7XG4gICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJEZWNyeXB0aW9uIGZhaWxlZC4gUGFzc3dvcmQgY2FjaGUgY2xlYXJlZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBTYXZlIGNoYW5nZXMgaWYgYW55IGRlY3J5cHRpb24gd2FzIHN1Y2Nlc3NmdWxcbiAgICAgICAgaWYoY2hhbmdlZCkgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGYsIHR4dCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFNob3cgc3VjY2VzcyBvciBubyBtYXRjaGVzIGZvdW5kIG1lc3NhZ2VcbiAgICAgIGlmICh1bmxvY2tlZCA+IDApIHtcbiAgICAgICAgc3RhdHVzQmFyLnRleHRDb250ZW50ID0gYFN1Y2Nlc3NmdWxseSBkZWNyeXB0ZWQgJHt1bmxvY2tlZH0gaXRlbShzKWA7XG4gICAgICAgIHN0YXR1c0Jhci5hZGRDbGFzcyhcInBpaS1zdGF0dXMtc3VjY2Vzc1wiKTtcbiAgICAgICAgbmV3IE5vdGljZShgU3VjY2Vzc2Z1bGx5IGRlY3J5cHRlZCAke3VubG9ja2VkfSBpdGVtKHMpYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzdGF0dXNCYXIudGV4dENvbnRlbnQgPSBcIk5vIGVuY3J5cHRlZCBjb250ZW50IGZvdW5kIG9yIGluY29ycmVjdCBwYXNzd29yZFwiO1xuICAgICAgICBuZXcgTm90aWNlKFwiTm8gZW5jcnlwdGVkIGNvbnRlbnQgZm91bmQgb3IgaW5jb3JyZWN0IHBhc3N3b3JkXCIpO1xuICAgICAgICAvLyBDbGVhciBjYWNoZWQgcGFzc3dvcmQgaWYgZGVjcnlwdGlvbiBmYWlsZWRcbiAgICAgICAgdGhpcy5jbGVhckNhY2hlZFBhc3N3b3JkKCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEtlZXAgc3RhdHVzIHZpc2libGUgZm9yIGEgbW9tZW50LCB0aGVuIHJlbW92ZVxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlmIChzdGF0dXNCYXIgJiYgc3RhdHVzQmFyLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICBzdGF0dXNCYXIucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICAgIH0sIDMwMDApO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJEZWNyeXB0aW9uIGVycm9yOlwiLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKFwiRXJyb3IgZHVyaW5nIGRlY3J5cHRpb24uIFBsZWFzZSB0cnkgYWdhaW4uXCIpO1xuICAgICAgXG4gICAgICBpZiAoc3RhdHVzQmFyICYmIHN0YXR1c0Jhci5wYXJlbnROb2RlKSB7XG4gICAgICAgIHN0YXR1c0Jhci5yZW1vdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBQbHVnaW4sIFdvcmtzcGFjZUxlYWYsIFZpZXcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MsIFBpaVNldHRpbmdzLCBQaWlTZXR0aW5nVGFiIH0gZnJvbSBcIi4vc3JjL3NldHRpbmdzXCI7XG5pbXBvcnQgeyByZWdpc3RlckNvbW1hbmRzIH0gZnJvbSBcIi4vc3JjL2NvbW1hbmRzXCI7XG5pbXBvcnQgeyBWSUVXX1RZUEVfUElJLCBQaWlTaWRlYmFyVmlldyB9IGZyb20gXCIuL3VpL1BpaVNpZGViYXJWaWV3XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBpaUxvY2tQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICBzZXR0aW5nczogUGlpU2V0dGluZ3M7XG5cbiAgLyogXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwIExpZmVjeWNsZSBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDAgKi9cbiAgYXN5bmMgb25sb2FkKCkge1xuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cbiAgICAvLyBSZWdpc3RlciB0aGUgc2lkZWJhciB2aWV3IHdpdGggcHJvcGVyIHR5cGUgY2FzdGluZ1xuICAgIHRoaXMucmVnaXN0ZXJWaWV3KFxuICAgICAgVklFV19UWVBFX1BJSSxcbiAgICAgIChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiAobmV3IFBpaVNpZGViYXJWaWV3KGxlYWYsIHRoaXMpIGFzIHVua25vd24pIGFzIFZpZXdcbiAgICApO1xuXG4gICAgLy8gc2hpZWxkIGljb24gXHUyMDEzIHNpZGViYXIgdG9nZ2xlXG4gICAgdGhpcy5hZGRSaWJib25JY29uKFwic2hpZWxkXCIsIFwiTG9jayBhbmQgRmluZFwiLCAoKSA9PiB0aGlzLmFjdGl2YXRlU2lkZWJhcigpKTtcblxuICAgIC8vIHNldHRpbmdzIHRhYiArIGNvbW1hbmRzXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBQaWlTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG4gICAgcmVnaXN0ZXJDb21tYW5kcyh0aGlzKTtcbiAgfVxuXG4gIG9udW5sb2FkKCkge1xuICAgIHRoaXMuYXBwLndvcmtzcGFjZS5kZXRhY2hMZWF2ZXNPZlR5cGUoVklFV19UWVBFX1BJSSk7XG4gIH1cblxuICAvKiBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDAgSGVscGVycyBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDAgKi9cbiAgcHJpdmF0ZSBhc3luYyBhY3RpdmF0ZVNpZGViYXIoKSB7XG4gICAgLy8gRm9jdXMgaWYgYWxyZWFkeSBvcGVuLCBvdGhlcndpc2UgY3JlYXRlIG5ldyBsZWFmXG4gICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfUElJKTtcbiAgICBcbiAgICBpZiAobGVhdmVzLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIElmIGEgbGVhZiB3aXRoIG91ciB2aWV3IGFscmVhZHkgZXhpc3RzLCByZXZlYWwgaXRcbiAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYXZlc1swXSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIE90aGVyd2lzZSBjcmVhdGUgYSBuZXcgbGVhZlxuICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigndGFiJyk7XG4gICAgYXdhaXQgbGVhZi5zZXRWaWV3U3RhdGUoe1xuICAgICAgdHlwZTogVklFV19UWVBFX1BJSSxcbiAgICAgIGFjdGl2ZTogdHJ1ZSxcbiAgICB9KTtcbiAgICBcbiAgICB0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgIGNvbnN0IHNhdmVkID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuICAgIHRoaXMuc2V0dGluZ3MgPSB7IC4uLkRFRkFVTFRfU0VUVElOR1MsIC4uLnNhdmVkIH07XG4gIH1cblxuICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG4gICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgfVxufVxuIiwgImltcG9ydCB7XG4gICAgQXBwLFxuICAgIFBsdWdpblNldHRpbmdUYWIsXG4gICAgU2V0dGluZyxcbiAgICBOb3RpY2UsXG4gIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG4gIGltcG9ydCB0eXBlIFBpaUxvY2tQbHVnaW4gZnJvbSBcIi4uL21haW5cIjtcbiAgXG4gIC8qIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMCBUeXBlIGFuZCBEZWZhdWx0IFZhbHVlIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMCAqL1xuICBleHBvcnQgaW50ZXJmYWNlIFBhdHRlcm5XaXRoTWV0YWRhdGEge1xuICAgIHBhdHRlcm46IHN0cmluZztcbiAgICBzb3VyY2U6IHN0cmluZzsgLy8gJ3VzZXInIG9yIGNvdW50cnkgY29kZSBsaWtlICdVUycsICdLb3JlYSdcbiAgICBkaXNwbGF5TmFtZTogc3RyaW5nOyAvLyAnVXNlciBQYXR0ZXJuIDEnIG9yICdVbml0ZWQgU3RhdGVzIC0gU1NOJ1xuICB9XG5cbiAgZXhwb3J0IGludGVyZmFjZSBQaWlTZXR0aW5ncyB7XG4gICAgcGF0dGVybnM6IHN0cmluZ1tdOyAgICAgICAgICAvLyBSZWdleCBsaXN0cyAoZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkpXG4gICAgcGF0dGVybk1ldGFkYXRhOiBQYXR0ZXJuV2l0aE1ldGFkYXRhW107IC8vIEVuaGFuY2VkIHBhdHRlcm4gdHJhY2tpbmdcbiAgICBlbmNyeXB0QWxnbzogXCJBRVMtR0NNXCI7ICAgICAgLy8gUHJlcGFyZSBmb3IgZnV0dXJlIGV4cGFuc2lvbiBvZiBvcHRpb25zXG4gICAgc3RvcmVkUGFzc3dvcmQ/OiBzdHJpbmc7ICAgICAvLyBUZW1wb3JhcmlseSBzdG9yZWQgcGFzc3dvcmQgKGhhc2hlZClcbiAgICBkZWZhdWx0UGF0dGVybnM6IHN0cmluZzsgICAgIC8vIElOSSBmb3JtYXQgc3RyaW5nIHdpdGggY291bnRyeS1zcGVjaWZpYyBwYXR0ZXJuc1xuICAgIHNlbGVjdGVkQ291bnRyaWVzOiBzdHJpbmdbXTsgLy8gTGlzdCBvZiBzZWxlY3RlZCBjb3VudHJpZXNcbiAgfVxuICBcbiAgZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFBpaVNldHRpbmdzID0ge1xuICAgIHBhdHRlcm5zOiBbXCJcXFxcZHs2fS1cXFxcZHs3fVwiLCBcIlxcXFxkezN9LVxcXFxkezR9LVxcXFxkezR9XCJdLCAvLyBTb2NpYWwgU2VjdXJpdHkgTnVtYmVyLVBob25lIE51bWJlciBFeGFtcGxlXG4gICAgcGF0dGVybk1ldGFkYXRhOiBbXG4gICAgICB7IHBhdHRlcm46IFwiXFxcXGR7Nn0tXFxcXGR7N31cIiwgc291cmNlOiBcInVzZXJcIiwgZGlzcGxheU5hbWU6IFwiVXNlciBQYXR0ZXJuIDFcIiB9LFxuICAgICAgeyBwYXR0ZXJuOiBcIlxcXFxkezN9LVxcXFxkezR9LVxcXFxkezR9XCIsIHNvdXJjZTogXCJ1c2VyXCIsIGRpc3BsYXlOYW1lOiBcIlVzZXIgUGF0dGVybiAyXCIgfVxuICAgIF0sXG4gICAgZW5jcnlwdEFsZ286IFwiQUVTLUdDTVwiLFxuICAgIHN0b3JlZFBhc3N3b3JkOiB1bmRlZmluZWQsXG4gICAgZGVmYXVsdFBhdHRlcm5zOiBcIlwiLCAvLyBXaWxsIGJlIGxvYWRlZCBmcm9tIGV4dGVybmFsIGZpbGVcbiAgICBzZWxlY3RlZENvdW50cmllczogW10sIC8vIE5vIGNvdW50cmllcyBzZWxlY3RlZCBieSBkZWZhdWx0XG4gIH07XG5cbiAgLyogXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwXHUyNTAwIERlZmF1bHQgUGF0dGVybnMgVXRpbGl0aWVzIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMCAqL1xuICBleHBvcnQgaW50ZXJmYWNlIENvdW50cnlQYXR0ZXJuIHtcbiAgICBkaXNwbGF5TmFtZTogc3RyaW5nOyAvLyBIdW1hbiByZWFkYWJsZSBuYW1lIGxpa2UgXCJVbml0ZWQgU3RhdGVzXCJcbiAgICBuYW1lOiBzdHJpbmc7ICAgICAgICAvLyBSZWdleCBwYXR0ZXJuIGZvciBwZXJzb24gbmFtZXNcbiAgICBhZGRyZXNzOiBzdHJpbmc7ICAgICAvLyBSZWdleCBwYXR0ZXJuIGZvciBhZGRyZXNzZXMvSURzXG4gICAgcGhvbmU6IHN0cmluZzsgICAgICAgLy8gUmVnZXggcGF0dGVybiBmb3IgcGhvbmUgbnVtYmVyc1xuICB9XG5cbiAgZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWREZWZhdWx0UGF0dGVybnNGcm9tRmlsZShwbHVnaW46IFBpaUxvY2tQbHVnaW4pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBhZGFwdGVyID0gcGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyO1xuICAgICAgY29uc3QgcGx1Z2luRGlyID0gcGx1Z2luLm1hbmlmZXN0LmRpciB8fCAnJztcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gYCR7cGx1Z2luRGlyfS9kZWZhdWx0LXBhdHRlcm5zLmluaWA7XG4gICAgICBcbiAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBhZGFwdGVyLnJlYWQoZmlsZVBhdGgpO1xuICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignQ291bGQgbm90IGxvYWQgZGVmYXVsdC1wYXR0ZXJucy5pbmksIHVzaW5nIGVtcHR5IHBhdHRlcm5zOicsIGVycm9yKTtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gcGFyc2VEZWZhdWx0UGF0dGVybnMoaW5pU3RyaW5nOiBzdHJpbmcpOiBSZWNvcmQ8c3RyaW5nLCBDb3VudHJ5UGF0dGVybj4ge1xuICAgIGNvbnN0IHJlc3VsdDogUmVjb3JkPHN0cmluZywgQ291bnRyeVBhdHRlcm4+ID0ge307XG4gICAgY29uc3QgbGluZXMgPSBpbmlTdHJpbmcuc3BsaXQoJ1xcbicpO1xuICAgIGxldCBjdXJyZW50U2VjdGlvbiA9ICcnO1xuXG4gICAgLy8gQ291bnRyeSBkaXNwbGF5IG5hbWUgbWFwcGluZ1xuICAgIGNvbnN0IGNvdW50cnlEaXNwbGF5TmFtZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgICAnVVMnOiAnVW5pdGVkIFN0YXRlcycsXG4gICAgICAnS29yZWEnOiAnU291dGggS29yZWEnLFxuICAgICAgJ0phcGFuJzogJ0phcGFuJyxcbiAgICAgICdUYWl3YW4nOiAnVGFpd2FuJyxcbiAgICAgICdJbmRpYSc6ICdJbmRpYScsXG4gICAgICAnTm9uZSc6ICdObyBEZWZhdWx0IFBhdHRlcm4nXG4gICAgfTtcblxuICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgY29uc3QgdHJpbW1lZCA9IGxpbmUudHJpbSgpO1xuICAgICAgaWYgKCF0cmltbWVkKSBjb250aW51ZTtcblxuICAgICAgaWYgKHRyaW1tZWQuc3RhcnRzV2l0aCgnWycpICYmIHRyaW1tZWQuZW5kc1dpdGgoJ10nKSkge1xuICAgICAgICBjdXJyZW50U2VjdGlvbiA9IHRyaW1tZWQuc2xpY2UoMSwgLTEpO1xuICAgICAgICByZXN1bHRbY3VycmVudFNlY3Rpb25dID0geyBcbiAgICAgICAgICBkaXNwbGF5TmFtZTogY291bnRyeURpc3BsYXlOYW1lc1tjdXJyZW50U2VjdGlvbl0gfHwgY3VycmVudFNlY3Rpb24sXG4gICAgICAgICAgbmFtZTogJycsIFxuICAgICAgICAgIGFkZHJlc3M6ICcnLFxuICAgICAgICAgIHBob25lOiAnJ1xuICAgICAgICB9O1xuICAgICAgfSBlbHNlIGlmIChjdXJyZW50U2VjdGlvbiAmJiB0cmltbWVkLmluY2x1ZGVzKCc9JykpIHtcbiAgICAgICAgY29uc3QgW2tleSwgLi4udmFsdWVQYXJ0c10gPSB0cmltbWVkLnNwbGl0KCc9Jyk7XG4gICAgICAgIGNvbnN0IHZhbHVlID0gdmFsdWVQYXJ0cy5qb2luKCc9Jyk7XG4gICAgICAgIGlmIChrZXkgPT09ICduYW1lJykge1xuICAgICAgICAgIHJlc3VsdFtjdXJyZW50U2VjdGlvbl0ubmFtZSA9IHZhbHVlO1xuICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ2FkZHJlc3MnKSB7XG4gICAgICAgICAgcmVzdWx0W2N1cnJlbnRTZWN0aW9uXS5hZGRyZXNzID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSBpZiAoa2V5ID09PSAncGhvbmUnKSB7XG4gICAgICAgICAgcmVzdWx0W2N1cnJlbnRTZWN0aW9uXS5waG9uZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBzZXJpYWxpemVEZWZhdWx0UGF0dGVybnMocGF0dGVybnM6IFJlY29yZDxzdHJpbmcsIENvdW50cnlQYXR0ZXJuPik6IHN0cmluZyB7XG4gICAgbGV0IHJlc3VsdCA9ICcnO1xuICAgIGZvciAoY29uc3QgW2NvdW50cnksIHBhdHRlcm5dIG9mIE9iamVjdC5lbnRyaWVzKHBhdHRlcm5zKSkge1xuICAgICAgcmVzdWx0ICs9IGBbJHtjb3VudHJ5fV1cXG5gO1xuICAgICAgcmVzdWx0ICs9IGBuYW1lPSR7cGF0dGVybi5uYW1lfVxcbmA7XG4gICAgICByZXN1bHQgKz0gYGFkZHJlc3M9JHtwYXR0ZXJuLmFkZHJlc3N9XFxuYDtcbiAgICAgIHJlc3VsdCArPSBgcGhvbmU9JHtwYXR0ZXJuLnBob25lfVxcbmA7XG4gICAgICBpZiAoT2JqZWN0LmtleXMocGF0dGVybnMpLmluZGV4T2YoY291bnRyeSkgPCBPYmplY3Qua2V5cyhwYXR0ZXJucykubGVuZ3RoIC0gMSkge1xuICAgICAgICByZXN1bHQgKz0gJ1xcbic7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBleHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZURlZmF1bHRQYXR0ZXJuc1RvRmlsZShwbHVnaW46IFBpaUxvY2tQbHVnaW4sIGNvbnRlbnQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBhZGFwdGVyID0gcGx1Z2luLmFwcC52YXVsdC5hZGFwdGVyO1xuICAgICAgY29uc3QgcGx1Z2luRGlyID0gcGx1Z2luLm1hbmlmZXN0LmRpciB8fCAnJztcbiAgICAgIGNvbnN0IGZpbGVQYXRoID0gYCR7cGx1Z2luRGlyfS9kZWZhdWx0LXBhdHRlcm5zLmluaWA7XG4gICAgICBcbiAgICAgIGF3YWl0IGFkYXB0ZXIud3JpdGUoZmlsZVBhdGgsIGNvbnRlbnQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdDb3VsZCBub3Qgc2F2ZSBkZWZhdWx0LXBhdHRlcm5zLmluaTonLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKCdGYWlsZWQgdG8gc2F2ZSBkZWZhdWx0IHBhdHRlcm5zIGZpbGUnKTtcbiAgICB9XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gZ2V0UGF0dGVybnNGcm9tU2VsZWN0ZWRDb3VudHJpZXMoc2VsZWN0ZWRDb3VudHJpZXM6IHN0cmluZ1tdLCBkZWZhdWx0UGF0dGVybnM6IFJlY29yZDxzdHJpbmcsIENvdW50cnlQYXR0ZXJuPik6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBwYXR0ZXJuczogc3RyaW5nW10gPSBbXTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGNvdW50cnkgb2Ygc2VsZWN0ZWRDb3VudHJpZXMpIHtcbiAgICAgIGNvbnN0IGNvdW50cnlQYXR0ZXJuID0gZGVmYXVsdFBhdHRlcm5zW2NvdW50cnldO1xuICAgICAgaWYgKGNvdW50cnlQYXR0ZXJuKSB7XG4gICAgICAgIC8vIEFkZCBuYW1lIHBhdHRlcm5zXG4gICAgICAgIGlmIChjb3VudHJ5UGF0dGVybi5uYW1lKSB7XG4gICAgICAgICAgY29uc3QgbmFtZVBhdHRlcm5zID0gY291bnRyeVBhdHRlcm4ubmFtZS5zcGxpdCgnfCcpLmZpbHRlcihwID0+IHAudHJpbSgpKTtcbiAgICAgICAgICBwYXR0ZXJucy5wdXNoKC4uLm5hbWVQYXR0ZXJucyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQWRkIGFkZHJlc3MgcGF0dGVybnNcbiAgICAgICAgaWYgKGNvdW50cnlQYXR0ZXJuLmFkZHJlc3MpIHtcbiAgICAgICAgICBjb25zdCBhZGRyZXNzUGF0dGVybnMgPSBjb3VudHJ5UGF0dGVybi5hZGRyZXNzLnNwbGl0KCd8JykuZmlsdGVyKHAgPT4gcC50cmltKCkpO1xuICAgICAgICAgIHBhdHRlcm5zLnB1c2goLi4uYWRkcmVzc1BhdHRlcm5zKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBBZGQgcGhvbmUgcGF0dGVybnNcbiAgICAgICAgaWYgKGNvdW50cnlQYXR0ZXJuLnBob25lKSB7XG4gICAgICAgICAgY29uc3QgcGhvbmVQYXR0ZXJucyA9IGNvdW50cnlQYXR0ZXJuLnBob25lLnNwbGl0KCd8JykuZmlsdGVyKHAgPT4gcC50cmltKCkpO1xuICAgICAgICAgIHBhdHRlcm5zLnB1c2goLi4ucGhvbmVQYXR0ZXJucyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHBhdHRlcm5zO1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIHN5bmNQYXR0ZXJuTWV0YWRhdGEocGx1Z2luOiBQaWlMb2NrUGx1Z2luLCBkZWZhdWx0UGF0dGVybnM6IFJlY29yZDxzdHJpbmcsIENvdW50cnlQYXR0ZXJuPikge1xuICAgIC8vIEluaXRpYWxpemUgbWV0YWRhdGEgaWYgaXQgZG9lc24ndCBleGlzdFxuICAgIGlmICghcGx1Z2luLnNldHRpbmdzLnBhdHRlcm5NZXRhZGF0YSkge1xuICAgICAgcGx1Z2luLnNldHRpbmdzLnBhdHRlcm5NZXRhZGF0YSA9IFtdO1xuICAgIH1cblxuICAgIGNvbnN0IG5ld01ldGFkYXRhOiBQYXR0ZXJuV2l0aE1ldGFkYXRhW10gPSBbXTtcbiAgICBsZXQgdXNlclBhdHRlcm5Db3VudCA9IDE7XG5cbiAgICAvLyBQcm9jZXNzIGVhY2ggcGF0dGVybiBpbiB0aGUgcGF0dGVybnMgYXJyYXlcbiAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGx1Z2luLnNldHRpbmdzLnBhdHRlcm5zKSB7XG4gICAgICBsZXQgZm91bmQgPSBmYWxzZTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgaXQncyBmcm9tIGEgc2VsZWN0ZWQgY291bnRyeVxuICAgICAgZm9yIChjb25zdCBjb3VudHJ5IG9mIHBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZENvdW50cmllcykge1xuICAgICAgICBjb25zdCBjb3VudHJ5UGF0dGVybiA9IGRlZmF1bHRQYXR0ZXJuc1tjb3VudHJ5XTtcbiAgICAgICAgaWYgKGNvdW50cnlQYXR0ZXJuKSB7XG4gICAgICAgICAgLy8gQ2hlY2sgbmFtZSBwYXR0ZXJuc1xuICAgICAgICAgIGlmIChjb3VudHJ5UGF0dGVybi5uYW1lKSB7XG4gICAgICAgICAgICBjb25zdCBuYW1lUGF0dGVybnMgPSBjb3VudHJ5UGF0dGVybi5uYW1lLnNwbGl0KCd8JykuZmlsdGVyKHAgPT4gcC50cmltKCkpO1xuICAgICAgICAgICAgaWYgKG5hbWVQYXR0ZXJucy5pbmNsdWRlcyhwYXR0ZXJuKSkge1xuICAgICAgICAgICAgICBjb25zdCBwYXR0ZXJuSW5kZXggPSBuYW1lUGF0dGVybnMuaW5kZXhPZihwYXR0ZXJuKSArIDE7XG4gICAgICAgICAgICAgIG5ld01ldGFkYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgIHBhdHRlcm4sXG4gICAgICAgICAgICAgICAgc291cmNlOiBjb3VudHJ5LFxuICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBgJHtjb3VudHJ5fSBOYW1lICR7cGF0dGVybkluZGV4fWBcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIENoZWNrIGFkZHJlc3MgcGF0dGVybnNcbiAgICAgICAgICBpZiAoIWZvdW5kICYmIGNvdW50cnlQYXR0ZXJuLmFkZHJlc3MpIHtcbiAgICAgICAgICAgIGNvbnN0IGFkZHJlc3NQYXR0ZXJucyA9IGNvdW50cnlQYXR0ZXJuLmFkZHJlc3Muc3BsaXQoJ3wnKS5maWx0ZXIocCA9PiBwLnRyaW0oKSk7XG4gICAgICAgICAgICBpZiAoYWRkcmVzc1BhdHRlcm5zLmluY2x1ZGVzKHBhdHRlcm4pKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHBhdHRlcm5JbmRleCA9IGFkZHJlc3NQYXR0ZXJucy5pbmRleE9mKHBhdHRlcm4pICsgMTtcbiAgICAgICAgICAgICAgbmV3TWV0YWRhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgcGF0dGVybixcbiAgICAgICAgICAgICAgICBzb3VyY2U6IGNvdW50cnksXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IGAke2NvdW50cnl9IEFkZHJlc3MgJHtwYXR0ZXJuSW5kZXh9YFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gQ2hlY2sgcGhvbmUgcGF0dGVybnNcbiAgICAgICAgICBpZiAoIWZvdW5kICYmIGNvdW50cnlQYXR0ZXJuLnBob25lKSB7XG4gICAgICAgICAgICBjb25zdCBwaG9uZVBhdHRlcm5zID0gY291bnRyeVBhdHRlcm4ucGhvbmUuc3BsaXQoJ3wnKS5maWx0ZXIocCA9PiBwLnRyaW0oKSk7XG4gICAgICAgICAgICBpZiAocGhvbmVQYXR0ZXJucy5pbmNsdWRlcyhwYXR0ZXJuKSkge1xuICAgICAgICAgICAgICBjb25zdCBwYXR0ZXJuSW5kZXggPSBwaG9uZVBhdHRlcm5zLmluZGV4T2YocGF0dGVybikgKyAxO1xuICAgICAgICAgICAgICBuZXdNZXRhZGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuLFxuICAgICAgICAgICAgICAgIHNvdXJjZTogY291bnRyeSxcbiAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogYCR7Y291bnRyeX0gUGhvbmUgJHtwYXR0ZXJuSW5kZXh9YFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgZm91bmQgPSB0cnVlO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSWYgbm90IGZyb20gYSBjb3VudHJ5LCBpdCdzIGEgdXNlciBwYXR0ZXJuXG4gICAgICBpZiAoIWZvdW5kKSB7XG4gICAgICAgIG5ld01ldGFkYXRhLnB1c2goe1xuICAgICAgICAgIHBhdHRlcm4sXG4gICAgICAgICAgc291cmNlOiBcInVzZXJcIixcbiAgICAgICAgICBkaXNwbGF5TmFtZTogYFVzZXIgUGF0dGVybiAke3VzZXJQYXR0ZXJuQ291bnR9YFxuICAgICAgICB9KTtcbiAgICAgICAgdXNlclBhdHRlcm5Db3VudCsrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEgPSBuZXdNZXRhZGF0YTtcbiAgfVxuXG4gIGV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVQYXR0ZXJuSW5JTkkocGx1Z2luOiBQaWlMb2NrUGx1Z2luLCBvbGRQYXR0ZXJuOiBzdHJpbmcsIG5ld1BhdHRlcm46IHN0cmluZywgc291cmNlOiBzdHJpbmcsIGRlZmF1bHRQYXR0ZXJuczogUmVjb3JkPHN0cmluZywgQ291bnRyeVBhdHRlcm4+KSB7XG4gICAgaWYgKHNvdXJjZSAhPT0gJ3VzZXInKSB7XG4gICAgICAvLyBUaGlzIGlzIGEgY291bnRyeSBwYXR0ZXJuLCB1cGRhdGUgdGhlIElOSSBmaWxlXG4gICAgICBjb25zdCBjb3VudHJ5UGF0dGVybiA9IGRlZmF1bHRQYXR0ZXJuc1tzb3VyY2VdO1xuICAgICAgaWYgKGNvdW50cnlQYXR0ZXJuKSB7XG4gICAgICAgIGxldCB1cGRhdGVkID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGEgbmFtZSBwYXR0ZXJuXG4gICAgICAgIGlmIChjb3VudHJ5UGF0dGVybi5uYW1lKSB7XG4gICAgICAgICAgY29uc3QgbmFtZVBhdHRlcm5zID0gY291bnRyeVBhdHRlcm4ubmFtZS5zcGxpdCgnfCcpLmZpbHRlcihwID0+IHAudHJpbSgpKTtcbiAgICAgICAgICBjb25zdCBuYW1lSW5kZXggPSBuYW1lUGF0dGVybnMuaW5kZXhPZihvbGRQYXR0ZXJuKTtcbiAgICAgICAgICBpZiAobmFtZUluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgbmFtZVBhdHRlcm5zW25hbWVJbmRleF0gPSBuZXdQYXR0ZXJuO1xuICAgICAgICAgICAgY291bnRyeVBhdHRlcm4ubmFtZSA9IG5hbWVQYXR0ZXJucy5qb2luKCd8Jyk7XG4gICAgICAgICAgICB1cGRhdGVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYW4gYWRkcmVzcyBwYXR0ZXJuXG4gICAgICAgIGlmICghdXBkYXRlZCAmJiBjb3VudHJ5UGF0dGVybi5hZGRyZXNzKSB7XG4gICAgICAgICAgY29uc3QgYWRkcmVzc1BhdHRlcm5zID0gY291bnRyeVBhdHRlcm4uYWRkcmVzcy5zcGxpdCgnfCcpLmZpbHRlcihwID0+IHAudHJpbSgpKTtcbiAgICAgICAgICBjb25zdCBhZGRyZXNzSW5kZXggPSBhZGRyZXNzUGF0dGVybnMuaW5kZXhPZihvbGRQYXR0ZXJuKTtcbiAgICAgICAgICBpZiAoYWRkcmVzc0luZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgYWRkcmVzc1BhdHRlcm5zW2FkZHJlc3NJbmRleF0gPSBuZXdQYXR0ZXJuO1xuICAgICAgICAgICAgY291bnRyeVBhdHRlcm4uYWRkcmVzcyA9IGFkZHJlc3NQYXR0ZXJucy5qb2luKCd8Jyk7XG4gICAgICAgICAgICB1cGRhdGVkID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGlmIGl0J3MgYSBwaG9uZSBwYXR0ZXJuXG4gICAgICAgIGlmICghdXBkYXRlZCAmJiBjb3VudHJ5UGF0dGVybi5waG9uZSkge1xuICAgICAgICAgIGNvbnN0IHBob25lUGF0dGVybnMgPSBjb3VudHJ5UGF0dGVybi5waG9uZS5zcGxpdCgnfCcpLmZpbHRlcihwID0+IHAudHJpbSgpKTtcbiAgICAgICAgICBjb25zdCBwaG9uZUluZGV4ID0gcGhvbmVQYXR0ZXJucy5pbmRleE9mKG9sZFBhdHRlcm4pO1xuICAgICAgICAgIGlmIChwaG9uZUluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgcGhvbmVQYXR0ZXJuc1twaG9uZUluZGV4XSA9IG5ld1BhdHRlcm47XG4gICAgICAgICAgICBjb3VudHJ5UGF0dGVybi5waG9uZSA9IHBob25lUGF0dGVybnMuam9pbignfCcpO1xuICAgICAgICAgICAgdXBkYXRlZCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAodXBkYXRlZCkge1xuICAgICAgICAgIC8vIFNhdmUgYmFjayB0byBJTkkgZmlsZVxuICAgICAgICAgIGNvbnN0IHNlcmlhbGl6ZWQgPSBzZXJpYWxpemVEZWZhdWx0UGF0dGVybnMoZGVmYXVsdFBhdHRlcm5zKTtcbiAgICAgICAgICBhd2FpdCBzYXZlRGVmYXVsdFBhdHRlcm5zVG9GaWxlKHBsdWdpbiwgc2VyaWFsaXplZCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgXG4gIC8qIFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMFx1MjUwMCBTZXR0aW5nIFRhYiBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDBcdTI1MDAgKi9cbiAgZXhwb3J0IGNsYXNzIFBpaVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IFBpaUxvY2tQbHVnaW47XG4gIFxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFBpaUxvY2tQbHVnaW4pIHtcbiAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cbiAgXG4gICAgcHJpdmF0ZSBhc3luYyBoYW5kbGVQYXNzd29yZENoYW5nZSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCB7IFB3TW9kYWwgfSA9IGF3YWl0IGltcG9ydChcIi4uL3VpL1BpaVNpZGViYXJWaWV3XCIpO1xuICAgIGNvbnN0IG1vZGFsID0gbmV3IFB3TW9kYWwodGhpcy5hcHAsIFwiU2V0IEVuY3J5cHRpb24gUGFzc3dvcmRcIiwgdHJ1ZSk7XG4gICAgY29uc3QgcGFzc3dvcmQgPSBhd2FpdCBtb2RhbC53YWl0KCk7XG4gICAgXG4gICAgaWYgKHBhc3N3b3JkKSB7XG4gICAgICAvLyBTaW1wbGUgaGFzaCBmb3Igc3RvcmFnZSAoaW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB1c2UgcHJvcGVyIGtleSBkZXJpdmF0aW9uKVxuICAgICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICAgICAgY29uc3QgZGF0YSA9IGVuY29kZXIuZW5jb2RlKHBhc3N3b3JkKTtcbiAgICAgIGNvbnN0IGhhc2hCdWZmZXIgPSBhd2FpdCBjcnlwdG8uc3VidGxlLmRpZ2VzdCgnU0hBLTI1NicsIGRhdGEpO1xuICAgICAgY29uc3QgaGFzaEFycmF5ID0gQXJyYXkuZnJvbShuZXcgVWludDhBcnJheShoYXNoQnVmZmVyKSk7XG4gICAgICBjb25zdCBoYXNoSGV4ID0gaGFzaEFycmF5Lm1hcChiID0+IGIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsICcwJykpLmpvaW4oJycpO1xuICAgICAgXG4gICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdG9yZWRQYXNzd29yZCA9IGhhc2hIZXg7XG4gICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgIG5ldyBOb3RpY2UoXCJQYXNzd29yZCBzYXZlZCBzdWNjZXNzZnVsbHlcIik7XG4gICAgfVxuICB9XG5cbiAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuICAgICAgXG4gICAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgcmVuZGVyQ29udGVudCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICBjb250YWluZXJFbC5hZGRDbGFzcygncGlpLXNldHRpbmdzLWNvbnRhaW5lcicpO1xuXG4gICAgICAvLyBDcmVhdGUgY29sbGFwc2libGUgTWFuYWdlIFBhdHRlcm5zIHNlY3Rpb25cbiAgICAgIGNvbnN0IHBhdHRlcm5zSGVhZGVyID0gY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkZXRhaWxzXCIpO1xuICAgICAgcGF0dGVybnNIZWFkZXIuY3JlYXRlRWwoXCJzdW1tYXJ5XCIsIHsgdGV4dDogXCJNYW5hZ2UgUGF0dGVybnNcIiwgY2xzOiBcInBpaS1jb2xsYXBzaWJsZS1oZWFkZXJcIiB9KTtcbiAgICAgIGNvbnN0IHBhdHRlcm5zQ29udGFpbmVyID0gcGF0dGVybnNIZWFkZXIuY3JlYXRlRGl2KFwicGlpLXBhdHRlcm5zLWNvbnRhaW5lclwiKTtcblxuICAgICAgLy8gTG9hZCBkZWZhdWx0IHBhdHRlcm5zXG4gICAgICBjb25zdCBkZWZhdWx0UGF0dGVybnNDb250ZW50ID0gYXdhaXQgbG9hZERlZmF1bHRQYXR0ZXJuc0Zyb21GaWxlKHRoaXMucGx1Z2luKTtcbiAgICAgIGNvbnN0IGRlZmF1bHRQYXR0ZXJucyA9IHBhcnNlRGVmYXVsdFBhdHRlcm5zKGRlZmF1bHRQYXR0ZXJuc0NvbnRlbnQpO1xuICAgICAgXG4gICAgICAvLyBJbml0aWFsaXplIHBhdHRlcm5NZXRhZGF0YSBpZiBpdCBkb2Vzbid0IGV4aXN0IChmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSlcbiAgICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybk1ldGFkYXRhKSB7XG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBhdHRlcm5NZXRhZGF0YSA9IFtdO1xuICAgICAgICAvLyBNaWdyYXRlIGV4aXN0aW5nIHBhdHRlcm5zIHRvIG1ldGFkYXRhIGZvcm1hdFxuICAgICAgICBsZXQgdXNlclBhdHRlcm5Db3VudCA9IDE7XG4gICAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJucykge1xuICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBhdHRlcm5NZXRhZGF0YS5wdXNoKHtcbiAgICAgICAgICAgIHBhdHRlcm4sXG4gICAgICAgICAgICBzb3VyY2U6IFwidXNlclwiLFxuICAgICAgICAgICAgZGlzcGxheU5hbWU6IGBVc2VyIFBhdHRlcm4gJHt1c2VyUGF0dGVybkNvdW50fWBcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB1c2VyUGF0dGVybkNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICB9XG4gIFxuICAgICAgLy8gUGF0dGVybiBMaXN0IFVJIHdpdGggZW5oYW5jZWQgbmFtaW5nXG4gICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEuZm9yRWFjaCgocGF0dGVybk1ldGEsIGlkeCkgPT4ge1xuICAgICAgICBjb25zdCBzID0gbmV3IFNldHRpbmcocGF0dGVybnNDb250YWluZXIpXG4gICAgICAgICAgLnNldE5hbWUocGF0dGVybk1ldGEuZGlzcGxheU5hbWUpXG4gICAgICAgICAgLmFkZFRleHQoKHQpID0+XG4gICAgICAgICAgICB0XG4gICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIlxcXFxkezZ9LS4uLlwiKVxuICAgICAgICAgICAgICAuc2V0VmFsdWUocGF0dGVybk1ldGEucGF0dGVybilcbiAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2xkUGF0dGVybiA9IHBhdHRlcm5NZXRhLnBhdHRlcm47XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBwYXR0ZXJuIGluIGJvdGggYXJyYXlzXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybnNbaWR4XSA9IHY7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybk1ldGFkYXRhW2lkeF0ucGF0dGVybiA9IHY7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBpcyBhIGNvdW50cnkgcGF0dGVybiwgdXBkYXRlIHRoZSBJTkkgZmlsZVxuICAgICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZVBhdHRlcm5JbklOSSh0aGlzLnBsdWdpbiwgb2xkUGF0dGVybiwgdiwgcGF0dGVybk1ldGEuc291cmNlLCBkZWZhdWx0UGF0dGVybnMpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgIClcbiAgICAgICAgICAuYWRkRXh0cmFCdXR0b24oKGJ0bikgPT5cbiAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgICAuc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwicmVtb3ZlXCIpXG4gICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJucy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gSWYgcmVtb3ZpbmcgYSBjb3VudHJ5IHBhdHRlcm4sIGFsc28gcmVtb3ZlIGZyb20gc2VsZWN0ZWQgY291bnRyaWVzXG4gICAgICAgICAgICAgICAgaWYgKHBhdHRlcm5NZXRhLnNvdXJjZSAhPT0gJ3VzZXInKSB7XG4gICAgICAgICAgICAgICAgICBjb25zdCByZW1haW5pbmdDb3VudHJ5UGF0dGVybnMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEuZmlsdGVyKHAgPT4gcC5zb3VyY2UgPT09IHBhdHRlcm5NZXRhLnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICBpZiAocmVtYWluaW5nQ291bnRyeVBhdHRlcm5zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZENvdW50cmllcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkQ291bnRyaWVzLmZpbHRlcihjID0+IGMgIT09IHBhdHRlcm5NZXRhLnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICk7XG4gICAgICAgIC8vIERpc2FibGUgdGhlIHJlbW92ZSBidXR0b24gaWYgdGhlcmUncyBvbmx5IG9uZSBwYXR0ZXJuIGxlZnRcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnBhdHRlcm5zLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IHMuY29udHJvbEVsLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpO1xuICAgICAgICAgIGlmIChidXR0b24pIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICBcbiAgICAgIC8vICsgQnV0dG9uXG4gICAgICBuZXcgU2V0dGluZyhwYXR0ZXJuc0NvbnRhaW5lcikuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgIGJ0blxuICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiK1wiKVxuICAgICAgICAgIC5zZXRUb29sdGlwKFwiQWRkIHBhdHRlcm5cIilcbiAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBDb3VudCBleGlzdGluZyB1c2VyIHBhdHRlcm5zIHRvIGdldCB0aGUgbmV4dCBudW1iZXJcbiAgICAgICAgICAgIGNvbnN0IHVzZXJQYXR0ZXJuQ291bnQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEuZmlsdGVyKHAgPT4gcC5zb3VyY2UgPT09ICd1c2VyJykubGVuZ3RoICsgMTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybnMucHVzaChcIlwiKTtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBhdHRlcm5NZXRhZGF0YS5wdXNoKHtcbiAgICAgICAgICAgICAgcGF0dGVybjogXCJcIixcbiAgICAgICAgICAgICAgc291cmNlOiBcInVzZXJcIixcbiAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IGBVc2VyIFBhdHRlcm4gJHt1c2VyUGF0dGVybkNvdW50fWBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICB9KVxuICAgICAgKTtcblxuICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoclwiKTtcbiAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIkRlZmF1bHQgUGF0dGVybnNcIiB9KTtcblxuICAgICAgLy8gVXNlIHRoZSBhbHJlYWR5IGxvYWRlZCBkZWZhdWx0IHBhdHRlcm5zXG4gICAgICBjb25zdCBhdmFpbGFibGVDb3VudHJpZXMgPSBPYmplY3Qua2V5cyhkZWZhdWx0UGF0dGVybnMpLmZpbHRlcihjID0+IGMgIT09ICdOb25lJyk7XG5cbiAgICAgIC8vIFNob3cgY3VycmVudGx5IHNlbGVjdGVkIGNvdW50cmllc1xuICAgICAgY29uc3Qgc2VsZWN0ZWRDb3VudHJpZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZENvdW50cmllcztcbiAgICAgIGNvbnN0IHNlbGVjdGVkQ291bnRyeU5hbWVzID0gc2VsZWN0ZWRDb3VudHJpZXMubWFwKGMgPT4gZGVmYXVsdFBhdHRlcm5zW2NdPy5kaXNwbGF5TmFtZSB8fCBjKS5qb2luKCcsICcpO1xuICAgICAgXG4gICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJTZWxlY3RlZCBDb3VudHJpZXNcIilcbiAgICAgICAgLnNldERlc2Moc2VsZWN0ZWRDb3VudHJpZXMubGVuZ3RoID4gMCA/IHNlbGVjdGVkQ291bnRyeU5hbWVzIDogXCJObyBjb3VudHJpZXMgc2VsZWN0ZWRcIilcbiAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PlxuICAgICAgICAgIGJ0blxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJDbGVhciBBbGxcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRDb3VudHJpZXMgPSBbXTtcbiAgICAgICAgICAgICAgLy8gS2VlcCBvbmx5IHVzZXIgcGF0dGVybnNcbiAgICAgICAgICAgICAgY29uc3QgdXNlclBhdHRlcm5zID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybk1ldGFkYXRhLmZpbHRlcihwID0+IHAuc291cmNlID09PSAndXNlcicpO1xuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJucyA9IHVzZXJQYXR0ZXJucy5tYXAocCA9PiBwLnBhdHRlcm4pO1xuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEgPSB1c2VyUGF0dGVybnM7XG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiQ2xlYXJlZCBhbGwgc2VsZWN0ZWQgY291bnRyaWVzXCIpO1xuICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgIC8vIENvdW50cnkgc2VsZWN0aW9uIGJ1dHRvbnNcbiAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDRcIiwgeyB0ZXh0OiBcIkFkZCBDb3VudHJ5IFBhdHRlcm5zXCIgfSk7XG4gICAgICBjb25zdCBjb3VudHJ5QnV0dG9uc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdihcInBpaS1jb3VudHJ5LWJ1dHRvbnNcIik7XG4gICAgICBcbiAgICAgIGF2YWlsYWJsZUNvdW50cmllcy5mb3JFYWNoKGNvdW50cnkgPT4ge1xuICAgICAgICBjb25zdCBwYXR0ZXJuID0gZGVmYXVsdFBhdHRlcm5zW2NvdW50cnldO1xuICAgICAgICBjb25zdCBpc1NlbGVjdGVkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRDb3VudHJpZXMuaW5jbHVkZXMoY291bnRyeSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb3VudHJ5QnV0dG9uc0NvbnRhaW5lcilcbiAgICAgICAgICAuc2V0TmFtZShwYXR0ZXJuLmRpc3BsYXlOYW1lKVxuICAgICAgICAgIC5zZXREZXNjKGBBZGQgcGF0dGVybnMgZm9yICR7cGF0dGVybi5kaXNwbGF5TmFtZX1gKVxuICAgICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT5cbiAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChpc1NlbGVjdGVkID8gXCJSZW1vdmVcIiA6IFwiQWRkXCIpXG4gICAgICAgICAgICAgIC5zZXRDbGFzcyhpc1NlbGVjdGVkID8gXCJtb2Qtd2FybmluZ1wiIDogXCJtb2QtY3RhXCIpXG4gICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBDaGVjayBjdXJyZW50IHN0YXRlIGluc3RlYWQgb2YgdXNpbmcgc3RhbGUgaXNTZWxlY3RlZFxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRseVNlbGVjdGVkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2VsZWN0ZWRDb3VudHJpZXMuaW5jbHVkZXMoY291bnRyeSk7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRseVNlbGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgY291bnRyeSBhbmQgaXRzIHBhdHRlcm5zXG4gICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZENvdW50cmllcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnNlbGVjdGVkQ291bnRyaWVzLmZpbHRlcihjID0+IGMgIT09IGNvdW50cnkpO1xuICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSBjb3VudHJ5J3MgcGF0dGVybnMgZnJvbSBib3RoIGFycmF5c1xuICAgICAgICAgICAgICAgICAgY29uc3QgYWxsQ291bnRyeVBhdHRlcm5zOiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgICAgaWYgKHBhdHRlcm4ubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuYW1lUGF0dGVybnMgPSBwYXR0ZXJuLm5hbWUuc3BsaXQoJ3wnKS5maWx0ZXIocCA9PiBwLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgICAgIGFsbENvdW50cnlQYXR0ZXJucy5wdXNoKC4uLm5hbWVQYXR0ZXJucyk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5hZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkZHJlc3NQYXR0ZXJucyA9IHBhdHRlcm4uYWRkcmVzcy5zcGxpdCgnfCcpLmZpbHRlcihwID0+IHAudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgYWxsQ291bnRyeVBhdHRlcm5zLnB1c2goLi4uYWRkcmVzc1BhdHRlcm5zKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIGlmIChwYXR0ZXJuLnBob25lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBob25lUGF0dGVybnMgPSBwYXR0ZXJuLnBob25lLnNwbGl0KCd8JykuZmlsdGVyKHAgPT4gcC50cmltKCkpO1xuICAgICAgICAgICAgICAgICAgICBhbGxDb3VudHJ5UGF0dGVybnMucHVzaCguLi5waG9uZVBhdHRlcm5zKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBhdHRlcm5zID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybnMuZmlsdGVyKHAgPT4gIWFsbENvdW50cnlQYXR0ZXJucy5pbmNsdWRlcyhwKSk7XG4gICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEuZmlsdGVyKHAgPT4gcC5zb3VyY2UgIT09IGNvdW50cnkpO1xuICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgUmVtb3ZlZCAke3BhdHRlcm4uZGlzcGxheU5hbWV9IHBhdHRlcm5zYCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgIC8vIEFkZCBjb3VudHJ5IGFuZCBpdHMgcGF0dGVybnMgKGNoZWNrIGlmIG5vdCBhbHJlYWR5IHNlbGVjdGVkKVxuICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZENvdW50cmllcy5pbmNsdWRlcyhjb3VudHJ5KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zZWxlY3RlZENvdW50cmllcy5wdXNoKGNvdW50cnkpO1xuICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgJHtwYXR0ZXJuLmRpc3BsYXlOYW1lfSBpcyBhbHJlYWR5IHNlbGVjdGVkYCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgY291bnRyeSdzIHBhdHRlcm5zIHRvIGJvdGggYXJyYXlzXG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIC8vIEFkZCBuYW1lIHBhdHRlcm5zIGZpcnN0XG4gICAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVQYXR0ZXJucyA9IHBhdHRlcm4ubmFtZS5zcGxpdCgnfCcpLmZpbHRlcihwID0+IHAudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybnMgPSBbLi4udGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybnMsIC4uLm5hbWVQYXR0ZXJuc107XG4gICAgICAgICAgICAgICAgICAgIG5hbWVQYXR0ZXJucy5mb3JFYWNoKChuYW1lUGF0dGVybiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuOiBuYW1lUGF0dGVybixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogY291bnRyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBgJHtjb3VudHJ5fSBOYW1lICR7aW5kZXggKyAxfWBcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIC8vIEFkZCBhZGRyZXNzIHBhdHRlcm5zXG4gICAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5hZGRyZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFkZHJlc3NQYXR0ZXJucyA9IHBhdHRlcm4uYWRkcmVzcy5zcGxpdCgnfCcpLmZpbHRlcihwID0+IHAudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybnMgPSBbLi4udGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybnMsIC4uLmFkZHJlc3NQYXR0ZXJuc107XG4gICAgICAgICAgICAgICAgICAgIGFkZHJlc3NQYXR0ZXJucy5mb3JFYWNoKChhZGRyZXNzUGF0dGVybiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYXR0ZXJuTWV0YWRhdGEucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXR0ZXJuOiBhZGRyZXNzUGF0dGVybixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZTogY291bnRyeSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBgJHtjb3VudHJ5fSBBZGRyZXNzICR7aW5kZXggKyAxfWBcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgIC8vIEFkZCBwaG9uZSBwYXR0ZXJuc1xuICAgICAgICAgICAgICAgICAgaWYgKHBhdHRlcm4ucGhvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGhvbmVQYXR0ZXJucyA9IHBhdHRlcm4ucGhvbmUuc3BsaXQoJ3wnKS5maWx0ZXIocCA9PiBwLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnBhdHRlcm5zID0gWy4uLnRoaXMucGx1Z2luLnNldHRpbmdzLnBhdHRlcm5zLCAuLi5waG9uZVBhdHRlcm5zXTtcbiAgICAgICAgICAgICAgICAgICAgcGhvbmVQYXR0ZXJucy5mb3JFYWNoKChwaG9uZVBhdHRlcm4sIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucGF0dGVybk1ldGFkYXRhLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgcGF0dGVybjogcGhvbmVQYXR0ZXJuLFxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBjb3VudHJ5LFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IGAke2NvdW50cnl9IFBob25lICR7aW5kZXggKyAxfWBcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBBZGRlZCAke3BhdHRlcm4uZGlzcGxheU5hbWV9IHBhdHRlcm5zYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICk7XG4gICAgICB9KTtcblxuICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoclwiKTtcbiAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIlBhc3N3b3JkIE1hbmFnZW1lbnRcIiB9KTtcblxuICAgICAgLy8gUGFzc3dvcmQgc3RhdHVzXG4gICAgICBjb25zdCBoYXNTdG9yZWRQYXNzd29yZCA9ICEhdGhpcy5wbHVnaW4uc2V0dGluZ3Muc3RvcmVkUGFzc3dvcmQ7XG4gICAgICBjb25zdCBzdGF0dXNUZXh0ID0gaGFzU3RvcmVkUGFzc3dvcmQgPyBcIlBhc3N3b3JkIGlzIGN1cnJlbnRseSBzdG9yZWRcIiA6IFwiTm8gcGFzc3dvcmQgc3RvcmVkXCI7XG4gICAgICBjb25zdCBzdGF0dXNFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwicFwiLCB7IFxuICAgICAgICB0ZXh0OiBzdGF0dXNUZXh0LFxuICAgICAgICBjbHM6IGhhc1N0b3JlZFBhc3N3b3JkID8gXCJwaWktcGFzc3dvcmQtc3RhdHVzLWFjdGl2ZVwiIDogXCJwaWktcGFzc3dvcmQtc3RhdHVzLWluYWN0aXZlXCJcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDaGFuZ2UgcGFzc3dvcmQgYnV0dG9uXG4gICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoaGFzU3RvcmVkUGFzc3dvcmQgPyBcIkNoYW5nZSBQYXNzd29yZFwiIDogXCJTZXQgUGFzc3dvcmRcIilcbiAgICAgICAgLnNldERlc2MoaGFzU3RvcmVkUGFzc3dvcmQgPyBcIlVwZGF0ZSB5b3VyIGVuY3J5cHRpb24gcGFzc3dvcmRcIiA6IFwiU2V0IGEgcGFzc3dvcmQgZm9yIGVuY3J5cHRpb24gb3BlcmF0aW9uc1wiKVxuICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgICAgYnRuXG4gICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChoYXNTdG9yZWRQYXNzd29yZCA/IFwiQ2hhbmdlXCIgOiBcIlNldFwiKVxuICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlUGFzc3dvcmRDaGFuZ2UoKTtcbiAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdGhlIGRpc3BsYXlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgIC8vIENsZWFyIHBhc3N3b3JkIGJ1dHRvbiAob25seSBzaG93IGlmIHBhc3N3b3JkIGlzIHN0b3JlZClcbiAgICAgIGlmIChoYXNTdG9yZWRQYXNzd29yZCkge1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAuc2V0TmFtZShcIkNsZWFyIFN0b3JlZCBQYXNzd29yZFwiKVxuICAgICAgICAgIC5zZXREZXNjKFwiUmVtb3ZlIHRoZSBzdG9yZWQgcGFzc3dvcmQuIFlvdSB3aWxsIGJlIHByb21wdGVkIGZvciBwYXNzd29yZCBvbiBlYWNoIG9wZXJhdGlvbi5cIilcbiAgICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgICAgICBidG5cbiAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJDbGVhclwiKVxuICAgICAgICAgICAgICAuc2V0V2FybmluZygpXG4gICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zdG9yZWRQYXNzd29yZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiUGFzc3dvcmQgY2xlYXJlZCBzdWNjZXNzZnVsbHlcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdGhlIGRpc3BsYXlcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAiLCAiaW1wb3J0IHR5cGUgUGlpTG9ja1BsdWdpbiBmcm9tIFwiLi4vbWFpblwiO1xuaW1wb3J0IHsgc2NhblZhdWx0IH0gZnJvbSBcIi4vc2Nhbm5lclwiO1xuaW1wb3J0IHsgZW5jcnlwdCwgZGVjcnlwdCB9IGZyb20gXCIuL2NyeXB0b1wiO1xuaW1wb3J0IHsgUmVzdWx0c01vZGFsIH0gZnJvbSBcIi4uL3VpL1Jlc3VsdHNNb2RhbFwiO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJDb21tYW5kcyhwbHVnaW46IFBpaUxvY2tQbHVnaW4pIHtcbiAgLyogMS4gU2NhbiAqL1xuICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgaWQ6IFwicGlpLXNjYW5cIixcbiAgICBuYW1lOiBcIlBJSVx1MDBBMFNjYW5cIixcbiAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHNjYW5WYXVsdChwbHVnaW4pO1xuICAgICAgbmV3IFJlc3VsdHNNb2RhbChwbHVnaW4uYXBwLCByZXN1bHRzKS5vcGVuKCk7XG4gICAgfSxcbiAgfSk7XG5cbiAgLyogMi4gTG9jayAoTWF0Y2hpbmcgdG9rZW5pemF0aW9uICsgZW5jcnlwdGVkIHN0b3JhZ2UpICovXG4gIHBsdWdpbi5hZGRDb21tYW5kKHtcbiAgICBpZDogXCJwaWktbG9ja1wiLFxuICAgIG5hbWU6IFwiUElJXHUwMEEwTG9jayAoZW5jcnlwdClcIixcbiAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgLy8gVE9ETzogQWN0dWFsIGltcGxlbWVudGF0aW9uIC0gbWF0Y2hlcyBcdTIxOTIgdG9rZW4gcmVwbGFjZW1lbnQsIGVuY3J5cHQoKSwgc2F2ZURhdGEoKVxuICAgIH0sXG4gIH0pO1xuXG4gIC8qIDMuIFVubG9jayAqL1xuICBwbHVnaW4uYWRkQ29tbWFuZCh7XG4gICAgaWQ6IFwicGlpLXVubG9ja1wiLFxuICAgIG5hbWU6IFwiUElJXHUwMEEwVW5sb2NrIChkZWNyeXB0KVwiLFxuICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAvLyBUT0RPOiBFbnRlciBwYXNzd29yZCBcdTIxOTIgZGVjcnlwdCgpIFx1MjE5MiByZXZlcnQgdG9rZW5cbiAgICB9LFxuICB9KTtcbn1cbiIsICIvLyB1aS9SZXN1bHRzTW9kYWwudHNcbmltcG9ydCB7IEFwcCwgTW9kYWwsIE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB0eXBlIHsgTWF0Y2hJbmZvIH0gZnJvbSBcIi4uL3NyYy9zY2FubmVyXCI7XG5cbmV4cG9ydCBjbGFzcyBSZXN1bHRzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGFwcDogQXBwLFxuICAgIHByaXZhdGUgbWF0Y2hlczogTWF0Y2hJbmZvW11cbiAgKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgfVxuXG4gIG9uT3BlbigpOiB2b2lkIHtcbiAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICBjb250ZW50RWwuYWRkQ2xhc3MoXCJwaWktbW9kYWxcIik7XG4gICAgY29udGVudEVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBgUElJXHUwMEEwTWF0Y2hlcyAoJHt0aGlzLm1hdGNoZXMubGVuZ3RofSlgIH0pO1xuXG4gICAgaWYgKCF0aGlzLm1hdGNoZXMubGVuZ3RoKSB7XG4gICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJObyBQSUkgZm91bmQgXHVEODNDXHVERjg5XCIgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLyogXHVCOUFDXHVDMkE0XHVEMkI4IERPTSAqL1xuICAgIGNvbnN0IGxpc3QgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwicGlpLWxpc3RcIiB9KTtcblxuICAgIHRoaXMubWF0Y2hlcy5mb3JFYWNoKChtLCBpZHgpID0+IHtcbiAgICAgIGNvbnN0IGl0ZW0gPSBsaXN0LmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcInBpaS1pdGVtXCIgfSk7XG5cbiAgICAgIC8qIFx1MjcxNFx1RkUwRSBcdUNDQjRcdUQwNkNcdUJDMTVcdUMyQTQgKi9cbiAgICAgIGNvbnN0IGNiID0gaXRlbS5jcmVhdGVFbChcImlucHV0XCIsIHsgdHlwZTogXCJjaGVja2JveFwiIH0pIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICBjYi5jaGVja2VkID0gdHJ1ZTsgLy8gXHVBRTMwXHVCQ0Y4IFx1QzEyMFx1RDBERFxuXG4gICAgICAvKiBcdUI5RTRcdUNFNkQgXHVCQjM4XHVDNzkwXHVDNUY0ICsgXHVDNzA0XHVDRTU4ICovXG4gICAgICBpdGVtLmNyZWF0ZUVsKFwic3BhblwiLCB7XG4gICAgICAgIHRleHQ6IGAke20udGV4dH0gIFx1MjAxNCAgJHttLmZpbGUuYmFzZW5hbWV9OiR7bS5saW5lICsgMX1gLFxuICAgICAgICBjbHM6IFwicGlpLXRleHRcIixcbiAgICAgIH0pO1xuXG4gICAgICAvKiBcdTI1QjZcdUZFMEUgXHVEMzBDXHVDNzdDIFx1QzVGNFx1QUUzMCBcdUJDODRcdUQyQkMgKi9cbiAgICAgIGNvbnN0IGdvQnRuID0gaXRlbS5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IFwiT3BlblwiIH0pO1xuICAgICAgZ29CdG4ub25jbGljayA9ICgpID0+IHRoaXMub3BlbkF0UG9zaXRpb24obSk7XG4gICAgfSk7XG5cbiAgICAvKiBcdUIyRUJcdUFFMzAgXHVCQzg0XHVEMkJDICovXG4gICAgY29udGVudEVsLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcbiAgICAgIHRleHQ6IFwiQ2xvc2VcIixcbiAgICAgIGNsczogXCJtb2QtY3RhXCIsXG4gICAgfSkub25jbGljayA9ICgpID0+IHRoaXMuY2xvc2UoKTtcbiAgfVxuXG4gIC8qKiBcdUFDMTlcdUM3NDAgXHVEMzBDXHVDNzdDXHVDNzQ0IFx1QzVGNFx1QzVCNCBcdUNFRTRcdUMxMUMgXHVDNzc0XHVCM0Q5ICovXG4gIHByaXZhdGUgYXN5bmMgb3BlbkF0UG9zaXRpb24obTogTWF0Y2hJbmZvKSB7XG4gICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcbiAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKG0uZmlsZSk7XG4gICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgaWYgKHZpZXcpIHZpZXcuZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IG0ubGluZSwgY2g6IG0uY29sIH0pO1xuICB9XG5cbiAgb25DbG9zZSgpOiB2b2lkIHtcbiAgICB0aGlzLmNvbnRlbnRFbC5lbXB0eSgpO1xuICB9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFVQSxlQUFzQixVQUFVLFFBQTZDO0FBQzNFLFFBQU0sUUFBUSxPQUFPLElBQUk7QUFDekIsUUFBTSxXQUFXLE9BQU8sU0FBUyxTQUFTLElBQUksT0FBSyxJQUFJLE9BQU8sR0FBRyxHQUFHLENBQUM7QUFDckUsUUFBTSxVQUF1QixDQUFDO0FBRTlCLGFBQVcsUUFBUSxNQUFNLGlCQUFpQixHQUFHO0FBQzNDLFVBQU0sVUFBVSxNQUFNLE1BQU0sV0FBVyxJQUFJO0FBQzNDLFVBQU0sUUFBUSxRQUFRLE1BQU0sSUFBSTtBQUVoQyxVQUFNLFFBQVEsQ0FBQyxVQUFVLFlBQVk7QUFDbkMsZUFBUyxRQUFRLFFBQU07QUFwQjdCO0FBcUJRLG1CQUFXLEtBQUssU0FBUyxTQUFTLEVBQUUsR0FBRztBQUNyQyxrQkFBUSxLQUFLO0FBQUEsWUFDWDtBQUFBLFlBQ0EsTUFBTTtBQUFBLFlBQ04sTUFBSyxPQUFFLFVBQUYsWUFBVztBQUFBLFlBQ2hCLE1BQU0sRUFBRSxDQUFDO0FBQUEsVUFDWCxDQUFDO0FBQUEsUUFDSDtBQUFBLE1BQ0YsQ0FBQztBQUFBLElBQ0gsQ0FBQztBQUFBLEVBQ0g7QUFDQSxTQUFPO0FBQ1Q7QUFqQ0E7QUFBQTtBQUFBO0FBQUE7OztBQ0NBLGVBQXNCLFVBQVUsS0FBaUM7QUFDL0QsUUFBTSxNQUFNLElBQUksWUFBWTtBQUM1QixRQUFNLGNBQWMsTUFBTSxPQUFPLE9BQU87QUFBQSxJQUN0QztBQUFBLElBQ0EsSUFBSSxPQUFPLEdBQUc7QUFBQSxJQUNkLEVBQUUsTUFBTSxTQUFTO0FBQUEsSUFDakI7QUFBQSxJ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U0FBSztBQUFBLE1BQ0g7QUFBQSxNQUNBLENBQUMsU0FBeUIsSUFBSSxlQUFlLE1BQU0sSUFBSTtBQUFBLElBQ3pEO0FBR0EsU0FBSyxjQUFjLFVBQVUsaUJBQWlCLE1BQU0sS0FBSyxnQkFBZ0IsQ0FBQztBQUcxRSxTQUFLLGNBQWMsSUFBSSxjQUFjLEtBQUssS0FBSyxJQUFJLENBQUM7QUFDcEQscUJBQWlCLElBQUk7QUFBQSxFQUN2QjtBQUFBLEVBRUEsV0FBVztBQUNULFNBQUssSUFBSSxVQUFVLG1CQUFtQixhQUFhO0FBQUEsRUFDckQ7QUFBQTtBQUFBLEVBR0EsTUFBYyxrQkFBa0I7QUFFOUIsVUFBTSxTQUFTLEtBQUssSUFBSSxVQUFVLGdCQUFnQixhQUFhO0FBRS9ELFFBQUksT0FBTyxTQUFTLEdBQUc7QUFFckIsV0FBSyxJQUFJLFVBQVUsV0FBVyxPQUFPLENBQUMsQ0FBQztBQUN2QztBQUFBLElBQ0Y7QUFHQSxVQUFNLE9BQU8sS0FBSyxJQUFJLFVBQVUsUUFBUSxLQUFLO0FBQzdDLFVBQU0sS0FBSyxhQUFhO0FBQUEsTUFDdEIsTUFBTTtBQUFBLE1BQ04sUUFBUTtBQUFBLElBQ1YsQ0FBQztBQUVELFNBQUssSUFBSSxVQUFVLFdBQVcsSUFBSTtBQUFBLEVBQ3BDO0FBQUEsRUFFQSxNQUFjLGVBQWU7QUFDM0IsVUFBTSxRQUFRLE1BQU0sS0FBSyxTQUFTO0FBQ2xDLFNBQUssV0FBVyxFQUFFLEdBQUcsa0JBQWtCLEdBQUcsTUFBTTtBQUFBLEVBQ2xEO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDbkIsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBQUEsRUFDbkM7QUFDRjsiLAogICJuYW1lcyI6IFsiZSIsICJwd2QiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJQd01vZGFsIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
